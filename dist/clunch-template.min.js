/*!
 * clunch.js <@template> - üé® The Progressive JavaScript Interactive Picture Framework.
 * git+https://github.com/hai2007/clunch.git
 *
 * author hai2007 < https://hai2007.gitee.io/sweethome >
 *
 * version 0.1.0-alpha.2
 *
 * Copyright (c) 2020 hai2007 Ëµ∞‰∏ÄÊ≠•ÔºåÂÜçËµ∞‰∏ÄÊ≠•„ÄÇ
 * Released under the MIT license
 *
 * Date:Mon Dec 07 2020 17:28:28 GMT+0800 (GMT+08:00)
 */
(function(){"use strict";function n(e){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){n=function(e){return typeof e}}else{n=function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return n(e)}function v(e){return t(e)||r(e)||i(e)||o()}function t(e){if(Array.isArray(e))return a(e)}function r(e){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(e))return Array.from(e)}function i(e,t){if(!e)return;if(typeof e==="string")return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor)r=e.constructor.name;if(r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(e,t)}function a(e,t){if(t==null||t>e.length)t=e.length;for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e){var t=n(e);return e!=null&&(t==="object"||t==="function")}var s=Object.prototype.toString;function u(e){if(e==null){return e===undefined?"[object Undefined]":"[object Null]"}return s.call(e)}function e(e){var t=n(e);return t==="string"||t==="object"&&e!=null&&!Array.isArray(e)&&u(e)==="[object String]"}function f(e){if(!l(e)){return false}var t=u(e);return t==="[object Function]"||t==="[object AsyncFunction]"||t==="[object GeneratorFunction]"||t==="[object Proxy]"}function c(e){if(e===null||n(e)!=="object"||u(e)!="[object Object]"){return false}if(Object.getPrototypeOf(e)===null){return true}var t=e;while(Object.getPrototypeOf(t)!==null){t=Object.getPrototypeOf(t)}return Object.getPrototypeOf(e)===t}var d=function e(t,r){return r!==null&&n(r)==="object"&&t.indexOf(r.nodeType)>-1&&!c(r)};var m=e;var x=f;var h=function e(t){return Array.isArray(t)};var p=function e(t){return d([1,9,11],t)};var g=[];var y=13;var b=400;var _=null;function w(t,e,r){var s={timer:function e(t,r,n){if(!t){throw new Error("Tick is required!")}r=r||b;var i=(new Date).valueOf()+"_"+(Math.random()*1e3).toFixed(0);g.push({id:i,createTime:new Date,tick:t,duration:r,callback:n});s.start();return i},start:function e(){if(!_){_=setInterval(s.tick,y)}},tick:function e(){var t,r,e,n,i,a,o,l=g;g=[];g.length=0;for(r=0;r<l.length;r++){i=l[r];t=i.createTime;e=i.tick;a=i.duration;n=i.callback;o=(+new Date-t)/a;o=o>1?1:o;e(o);if(o<1&&i.id){g.push(i)}else if(n){n(o)}}if(g.length<=0){s.stop()}},stop:function e(){if(_){clearInterval(_);_=null}}};var n=s.timer(function(e){t(e)},e,r);return function(){var e;for(e in g){if(g[e].id==n){g[e].id=undefined;return}}}}var k=function e(t,r){for(var n in r){try{t[n]=r[n]}catch(e){throw new Error("Illegal property valueÔºÅ")}}return t};var $={whitespace:"[\\x20\\t\\r\\n\\f]"};var T=function e(t){if(/^[_$]/.test(t)){console.warn("The beginning of _ or $ is not allowedÔºö"+t)}};function A(e,t){for(var r in t){try{e[r]=t[r]}catch(e){throw new Error("Illegal property valueÔºÅ")}}return e}function S(s){s=A({u:.5},s);var u,f,c;var d=function e(t){if(u){var r=(t-f)/(c-f),n=r*r,i=r*n;var a=i*u[0]+n*u[1]+r*u[2]+u[3];return a*(c-f)}else throw new Error("You shoud first set the position!")};d.setP=function(e,t,r,n,i,a){if(e<r){f=e;c=r;var o=s.u*i,l=s.u*a;t/=r-e;n/=r-e;u=[2*t-2*n+o+l,3*n-3*t-2*o-l,o,t]}else throw new Error("The point x-position should be increamented!");return d};return d}function R(i){i=k({t:0},i);var a,r;var o=function e(t){if(a){r=-1;while(r+1<a.x.length&&(t>a.x[r+1]||r==-1&&t>=a.x[r+1])){r+=1}if(r==-1||r>=a.h.length)throw new Error("Coordinate crossing!");return a.h[r](t)}else{throw new Error("You shoud first set the position!")}};o.setT=function(e){if(typeof e==="number"){i.t=e}else{throw new Error("Expecting a figure!")}return o};o.setP=function(e){a={x:[],h:[]};var t,r=(e[1][1]-e[0][1])/(e[1][0]-e[0][0]),n;a.x[0]=e[0][0];for(t=1;t<e.length;t++){if(e[t][0]<=e[t-1][0])throw new Error("The point position should be increamented!");a.x[t]=e[t][0];n=t<e.length-1?(e[t+1][1]-e[t-1][1])/(e[t+1][0]-e[t-1][0]):(e[t][1]-e[t-1][1])/(e[t][0]-e[t-1][0]);a.h[t-1]=S({u:(1-i.t)*.5}).setP(e[t-1][0],e[t-1][1],e[t][0],e[t][1],r,n);r=n}return o};return o}function N(e,t){var r=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(e,null):e.currentStyle;return m(t)?r.getPropertyValue(t):r}var O=function e(t){var r=document.getElementsByTagName("head")[0];r.style["color"]=t;var n=N(r,"color");var i=n.replace(/^rgba?\(([^)]+)\)$/,"$1").split(new RegExp("\\,"+$.whitespace));return[+i[0],+i[1],+i[2],i[3]==undefined?1:+i[3]]};var P=function e(t,r){if(!(r&&r>=0&&r<=1))r=1;var n=[];for(var i=1;i<=t;i++){n.push("rgba("+(Math.random(1)*230+20).toFixed(0)+","+(Math.random(1)*230+20).toFixed(0)+","+(Math.random(1)*230+20).toFixed(0)+","+r+")")}return n};function z(e){var u=e||{},f,n;var i=function e(){var o=[],l=0,s=0;(function e(t,r){if(r>s)s=r;var n;for(n=0;n<t.children.length;n++){e(f[t.children[n]],r+1)}f[t.id].left=r+.5;if(n==0){if(o[r]==undefined)o[r]=-.5;if(o[r-1]==undefined)o[r-1]=-.5;f[t.id].top=o[r]+1;var i=o[r]+1+(f[t.pid].children.length-1)*.5;if(i-1<o[r-1])f[t.id].top=o[r-1]+1-(f[t.pid].children.length-1)*.5}else{f[t.id].top=(f[t.children[0]].top+f[t.children[n-1]].top)*.5}if(f[t.id].top<=o[r]){var a=o[r]+1-f[t.id].top;(function e(t,r){f[t].top+=a;if(o[r]<f[t].top)o[r]=f[t].top;var n;for(n=0;n<f[t].children.length;n++){e(f[t].children[n],r+1)}})(t.id,r)}o[r]=f[t.id].top;if(f[t.id].top+.5>l)l=f[t.id].top+.5})(f[n],0);return{node:f,root:n,size:l,deep:s+1}};var a=function e(a){var o={};var t=u.root(a),l,r;l=r=u.id(t);o[l]={data:t,pid:null,id:l,children:[]};var s=1;(function e(t,r){var n=u.child(t,a),i;s+=n?n.length:0;for(i=0;n&&i<n.length;i++){l=u.id(n[i]);o[r].children.push(l);o[l]={data:n[i],pid:r,id:l,children:[]};e(n[i],l)}})(t,l);return{value:[r,o],num:s}};var t=function e(t){var r=a(t);f=r.value[1];n=r.value[0];if(r.num==1){f[n].left=.5;f[n].top=.5;return{deep:1,node:f,root:n,size:1}}return i()};t.root=function(e){u.root=e;return t};t.child=function(e){u.child=e;return t};t.id=function(e){u.id=e;return t};return t}var E=function e(t,r,n,i,a){var o=Math.cos(n),l=Math.sin(n);return[+((i-t)*o-(a-r)*l+t).toFixed(7),+((i-t)*l+(a-r)*o+r).toFixed(7)]};var M=function e(t,r,n,i,a){var o=Math.sqrt(t*t+r*r);return[+(t*n/o+i).toFixed(7),+(r*n/o+a).toFixed(7)]};var I=function e(t,r,n,i,a){return[+(n*(i-t)+t).toFixed(7),+(n*(a-r)+r).toFixed(7)]};var C=function e(a){a=k({d:[1,1],c:[0,0],p:[0,0]},a);var o={rotate:function e(t){var r=a.d[0]+a.p[0],n=a.d[1]+a.p[1];var i=E(a.p[0],a.p[1],t,r,n);a.d=[i[0]-a.p[0],i[1]-a.p[1]];return o},move:function e(t){a.p=M(a.d[0],a.d[1],t,a.p[0],a.p[1]);return o},scale:function e(t){a.p=I(a.c[0],a.c[1],t,a.p[0],a.p[1]);return o},value:function e(){return a.p}};return o};function j(_){_=k({"begin-deg":0,deg:Math.PI*2},_);var m=z().root(_.root).child(_.child).id(_.id);var t=function e(t){var r=m(t);for(var n in r.node){r.node[n].deep=r.node[n].left-.5}if(_.type==="LR"||_.type==="RL"){var i=_.width/r.deep;if("RL"===_.type)i*=-1;var a=_.height/(r.size- -.5);for(var o in r.node){var l=r.node[o];r.node[o].left=+(("RL"==_.type?_.width:0)- -l.left*i).toFixed(7);r.node[o].top=+(l.top*a).toFixed(7)}}else if(_.type==="TB"||_.type==="BT"){var s=_.height/r.deep;if("BT"==_.type)s*=-1;var u=_.width/(r.size- -.5);var f,c;for(var d in r.node){var h=r.node[d];f=h.left;c=h.top;r.node[d].top=+(("BT"==_.type?_.height:0)- -f*s).toFixed(7);r.node[d].left=+(c*u).toFixed(7)}}else if(_.type==="circle"){if(r.deep==1&&r.size==1){r.node[r.root].left=_.cx;r.node[r.root].top=_.cy}else{var p=_.radius/(r.deep-1);var v=_.deg/(r.size- -.5);for(var g in r.node){var y=r.node[g];r.node[g].deg=(_["begin-deg"]- -v*y.top)%(Math.PI*2);var b=E(_.cx,_.cy,r.node[g].deg,_.cx- -p*(y.left-.5),_.cy);r.node[g].left=+b[0];r.node[g].top=+b[1]}}}if(x(_.drawer)){_.drawer(r);return e}else{return r}};t.config=function(e){_=k(_,e);return t};t.drawer=function(e){_.drawer=e;return t};return t}function D(i){var t=[];var e=function e(n){if(["boolean","number","json","string","color","any"].indexOf(i[n])>-1){t.unshift(function(t){var r=arguments.length>0?false:true;return function(e){return{type:i[n],required:r,animation:e,default:t}}})}else{t.unshift({$animation:w,$cardinal:R,$formatColor:O,$getRandomColors:P,$tree:j,$dot:C,$rotate:E,$move:M,$scale:I}[i[n]])}};for(var r=i.length-2;r>=0;r--){e(r)}return i[i.length-1].apply(this,t)}var W=function e(t,r){switch(t){case"boolean":{return r=="true"?true:false}case"number":{if(/deg$/.test(r))return(0- -r.replace(/deg$/,""))/180*Math.PI;if(/pi$/.test(r))return(0- -r.replace(/pi$/,""))*Math.PI;if(m(r))return+r;return r}case"json":{if(m(r)){return JSON.parse(r)}return r}}return r};function L(e,b){var _=0;return function e(t,r){var n=[];for(var i=0;i<t.length;i++){var a=t[i];if(r||a.name in b){var o={name:a.name,attrs:{},events:[],scope:{},index:_++};var l=r?{attrs:b[r].subAttrs[a.name]}:b[a.name];for(var s in a.attrs){if(/^c\-bind\:/.test(s)){a.attrs[s.replace(/^c\-bind\:/,"")]={isBind:true,express:a.attrs[s]}}else if(/^c\-on\:/.test(s)){var u=(s.replace(/^c\-on\:/,"")+"@default").split("@");o.events.push({event:u[0],region:u[1],method:a.attrs[s]})}else if("c-for"==s){var f=/^ {0,}\(/.test(a.attrs[s]);var c=f?/^ {0,}\( {0,}([0-9a-zA-Z_$]+) {0,}, {0,}([0-9a-zA-Z_$]+) {0,}\) {1,}in {1,}([^ ]+) {0,}$/.exec(a.attrs[s]):/^ {0,}([0-9a-zA-Z_$]+) {1,}in {1,}([^ ]+) {0,}$/.exec(a.attrs[s]);o["c-for"]={key:f?c[2]:null,value:c[1],data:f?c[3]:c[2]}}else if("c-if"==s){o["c-if"]=a.attrs[s]}else{a.attrs[s]={isBind:false,express:a.attrs[s]}}}for(var d in l.attrs){var h=l.attrs[d];if(h.required&&!(d in a.attrs)){throw new Error("attrs."+d+" is required for series "+a.name+"!")}o.attrs[d]={animation:h.animation,type:h.type,value:d in a.attrs?a.attrs[d]:{isBind:false,express:h["default"]}};if(!o.attrs[d].value.isBind){o.attrs[d].value.express=W(o.attrs[d].type,o.attrs[d].value.express)}}var p=[],v=[],g=[];if(a.children){for(var y=0;y<a.children.length;y++){if(m(a.children[y])){g.push(a.children[y])}else if(l.subAttrs&&a.children[y].name in l.subAttrs){v.push(a.children[y])}else{p.push(a.children[y])}}}o.children=e(p);o.subAttrs=e(v,a.name);o.text=g;n.push(o)}else{console.error("Series "+a.name+" is not defined!")}}return n}(e)}var B=function e(t,r,n,i,a){var o=Math.cos(n),l=Math.sin(n);return[+((i-t)*o-(a-r)*l+t).toFixed(7),+((i-t)*l+(a-r)*o+r).toFixed(7)]};function F(e,t,r,n,i,a,o){if(t<0){e+=t;t*=-1}var l=[],s;s=B(0,0,e,i,0);l[0]=s[0];l[1]=s[1];s=B(0,0,t,s[0],s[1]);l[2]=s[0];l[3]=s[1];s=B(0,0,e,a,0);l[4]=s[0];l[5]=s[1];s=B(0,0,t,s[0],s[1]);l[6]=s[0];l[7]=s[1];o(e,e+t,l[0]+r,l[1]+n,l[4]+r,l[5]+n,l[2]+r,l[3]+n,l[6]+r,l[7]+n,(a-i)*.5)}var U=function e(t,r,n,i,a){t.beginPath();t.translate(n,i);t.rotate(a);t.font=r["font-size"]+"px "+r["font-family"];return t};var q=function e(c,d,h,p,v,g,t,r){if(v>g){var n=v;v=g;g=n}t=t%(Math.PI*2);if(r>=Math.PI*1.999999||r<=-Math.PI*1.999999){r=Math.PI*2}else{r=r%(Math.PI*2)}F(t,r,h,p,v,g,function(e,t,r,n,i,a,o,l,s,u,f){if(f<0)f=-f;c.beginPath();c.moveTo(r,n);c.arc(h,p,v,e,t,false);if(d["arc-end-cap"]!="round")c.lineTo(s,u);else c.arc((o+s)*.5,(l+u)*.5,f,t-Math.PI,t,true);c.arc(h,p,g,t,e,true);if(d["arc-start-cap"]!="round")c.lineTo(r,n);else c.arc((r+i)*.5,(n+a)*.5,f,e,e-Math.PI,true)});if(d["arc-start-cap"]=="butt")c.closePath();return c};var V=function e(t,r,n,i){t.beginPath();t.moveTo(r+i,n);t.arc(r,n,i,0,Math.PI*2);return t};var J=function e(t,r,n,i,a){t.beginPath();t.rect(r,n,i,a);return t};var Y=function e(t,r,n,i,a){var o=t.createLinearGradient(r,n,i,a);var l={value:function e(){return o},addColorStop:function e(t,r){o.addColorStop(t,r);return l}};return l};var G=function e(t,r,n,i){var a=t.createRadialGradient(r,n,0,r,n,i);var o={value:function e(){return a},addColorStop:function e(t,r){a.addColorStop(t,r);return o}};return o};function Z(t,f,c){var d=t.getContext("2d");if(f==0||c==0)throw new Error("Canvas is hidden or size is zero!");t.style.width=f+"px";t.style.height=c+"px";t.setAttribute("width",f*2);t.setAttribute("height",c*2);d.scale(2,2);d.textBaseline="middle";d.textAlign="left";var l={"font-size":"16","font-family":"sans-serif","arc-start-cap":"butt","arc-end-cap":"butt"};var r=function e(t,r){if(t=="lineDash"){d.setLineDash(r)}else if(l[t]){l[t]=r}else{d[t]=r}};var h={config:function e(){if(arguments.length===1){if(n(arguments[0])!=="object")return d[arguments[0]];for(var t in arguments[0]){r(t,arguments[0][t])}}else if(arguments.length===2){r(arguments[0],arguments[1])}return h},fillText:function e(t,r,n,i){d.save();U(d,l,r,n,i||0).fillText(t,0,0);d.restore();return h},strokeText:function e(t,r,n,i){d.save();U(d,l,r,n,i||0).strokeText(t,0,0);d.restore();return h},fullText:function e(t,r,n,i){d.save();U(d,l,r,n,i||0);d.fillText(t,0,0);d.strokeText(t,0,0);d.restore();return h},beginPath:function e(){d.beginPath();return h},closePath:function e(){d.closePath();return h},moveTo:function e(t,r){d.moveTo(t,r);return h},lineTo:function e(t,r){d.lineTo(t,r);return h},arc:function e(t,r,n,i,a){d.arc(t,r,n,i,i+a,a<0);return h},fill:function e(){d.fill();return h},stroke:function e(){d.stroke();return h},full:function e(){d.fill();d.stroke();return h},save:function e(){d.save();return h},restore:function e(){d.restore();return h},quadraticCurveTo:function e(t,r,n,i){d.quadraticCurveTo(t,r,n,i);return h},bezierCurveTo:function e(t,r,n,i,a,o){d.bezierCurveTo(t,r,n,i,a,o);return h},clearRect:function e(t,r,n,i){d.clearRect(t||0,r||0,n||f,i||c);return h},toDataURL:function e(){return t.toDataURL()},drawImage:function e(t,r,n,i,a,o,l,s,u){r=r||0;n=n||0;o=o||0;l=l||0;s=s?s*2:f*2;u=u?u*2:c*2;if(t.nodeName=="CANVAS"){s=s/2;u=u/2;i=i?i*2:f*2;a=a?a*2:c*2}else{i=(i||t.width)*2;a=(a||t.height)*2}d.drawImage(t,r,n,i,a,o,l,s,u);return h},fillArc:function e(t,r,n,i,a,o){q(d,l,t,r,n,i,a,o).fill();return h},strokeArc:function e(t,r,n,i,a,o){q(d,l,t,r,n,i,a,o).stroke();return h},fullArc:function e(t,r,n,i,a,o){q(d,l,t,r,n,i,a,o);d.fill();d.stroke();return h},fillCircle:function e(t,r,n){V(d,t,r,n).fill();return h},strokeCircle:function e(t,r,n){V(d,t,r,n).stroke();return h},fullCircle:function e(t,r,n){V(d,t,r,n);d.fill();d.stroke();return h},fillRect:function e(t,r,n,i){J(d,t,r,n,i).fill();return h},strokeRect:function e(t,r,n,i){J(d,t,r,n,i).stroke();return h},fullRect:function e(t,r,n,i){J(d,t,r,n,i);d.fill();d.stroke();return h},createLinearGradient:function e(t,r,n,i){return Y(d,t,r,n,i)},createRadialGradient:function e(t,r,n){return G(d,t,r,n)}};return h}function H(e,t,r){if(window.attachEvent){e.attachEvent("on"+t,r)}else{e.addEventListener(t,r,false)}}var X=function e(t,r){var n=t.getBoundingClientRect();return{x:r.clientX-n.left,y:r.clientY-n.top}};function K(a){var o={},r=[0,0,0],n="r";var i,l=document.createElement("canvas");var s=0,u=0;return{erase:function e(){i.config({fillStyle:"rgb(255,255,255)"}).fillRect(0,0,s,u)},updateSize:function e(t,r){s=t;u=r;i=Z(l,t,r)},painter:function e(t){if(o[t]==undefined)o[t]={r:function e(){r[0]+=1;n="g";return"rgb("+r[0]+","+r[1]+","+r[2]+")"},g:function e(){r[1]+=1;n="b";return"rgb("+r[0]+","+r[1]+","+r[2]+")"},b:function e(){r[2]+=1;n="r";return"rgb("+r[0]+","+r[1]+","+r[2]+")"}}[n]();i.config({fillStyle:o[t],strokeStyle:o[t]});return i},getRegion:function e(t){var r=X(a.__canvas,t);r.x-=N(a.__canvas,"border-left-width").replace("px","");r.y-=N(a.__canvas,"border-top-width").replace("px","");var n=l.getContext("2d").getImageData(r.x*2-.5,r.y*2-.5,1,1).data;for(var i in o){if("rgb("+n[0]+","+n[1]+","+n[2]+")"==o[i]){return[i,r.x,r.y]}}return[null,r.x,r.y]}}}function Q(e){e.prototype.$$init=function(e){this.__options=e;this.__data=h(e.data)?D(e.data):x(e.data)?e.data():e.data;this._isMounted=false;this._isDestroyed=false;for(var t in e.methods){T(t);this[t]=h(e.methods[t])?D(e.methods[t]):e.methods[t]}for(var r in this.__data){T(r);this[r]=this.__data[r]}this.__renderFlag=!!e.render||!!e.template;if(!!e.render){this.__renderAOP=L(e.render,this.__defineSerirs)}else if(!!e.template){this.__renderOptions=this.$$templateCompiler(e.template);this.__renderAOP=L(this.__renderOptions,this.__defineSerirs)}this.__observeWatcher={flag:false,stop:null};this.__observeResize={help:true,flag:false,observer:null};this.__painter=null;this._width=0;this._height=0;this._min=0;this._max=0;this.__regionManager=K(this)}}function ee(e){e.prototype.$$lifecycle=function(e){if(x(e)){e()}else{if(["created","beforeMount","mounted","beforeUnmount","unmounted","beforeUpdate","updated","beforeResize","resized","beforeDraw","drawed","beforeDestroy","destroyed"].indexOf(e)>-1&&x(this.__options[e])){this.__options[e].call(this)}}return this}}var te={blankReg:new RegExp("[\\x20\\t\\r\\n\\f]"),blanksReg:/^[\x20\t\r\n\f]{0,}$/,identifier:/^[a-zA-Z_$][0-9a-zA-Z_$]{0,}$/};var re=["+","-","*","/","%","&","|","!","?",":","[","]","(",")",">","<","="];var ne=["+","-","*","/","%","&","|","!","?",":",">","<","=","<=",">=","==","===","!=","!=="];function ie(e,r,t){r=r.trim();var n=-1,i=null;var a=function e(){i=n++<r.length-1?r[n]:null;return i};var o=function e(t){return r.substring(n,t+n>r.length?r.length:t+n)};a();var l=[];while(true){if(n>=r.length)break;if(re.indexOf(i)>-1){if(["&","|","="].indexOf(i)>-1){if(["==="].indexOf(o(3))>-1){l.push(o(3));n+=2;a()}else if(["&&","||","=="].indexOf(o(2))>-1){l.push(o(2));n+=1;a()}else{throw new Error("Illegal expression : "+r+"\nstep='analyseExpress',index="+n)}}else{if(["!=="].indexOf(o(3))>-1){l.push(o(3));n+=2;a()}else if([">=","<=","!="].indexOf(o(2))>-1){l.push(o(2));n+=1;a()}else{l.push(i);a()}}}else if(['"',"'"].indexOf(i)>-1){var s="",u=i;a();while(i!=u){if(n>=r.length){throw new Error("String unclosed error : "+r+"\nstep='analyseExpress',index="+n)}s+=i;a()}l.push(s+"@string");a()}else if(/\d/.test(i)){var f="no";var s=i;a();while(n<r.length){if(/\d/.test(i)){s+=i;if(f=="error")f="yes"}else if("."==i&&f=="no"){s+=i;f="error"}else{break}a()}if(f=="error")s+="0";l.push(+s)}else if(["null","true"].indexOf(o(4))>-1){l.push({null:null,true:true}[o(4)]);n+=3;a()}else if(["false"].indexOf(o(5))>-1){l.push({false:false}[o(5)]);n+=4;a()}else if(["undefined"].indexOf(o(9))>-1){l.push({undefined:undefined}[o(9)]);n+=8;a()}else if(te.blankReg.test(i)){do{a()}while(te.blankReg.test(i)&&n<r.length)}else{var c=false;if(i=="."){c=true;a()}if(te.identifier.test(i)){var d=1;while(n+d<=r.length&&te.identifier.test(o(d))){d+=1}if(c){l.push("[");l.push(o(d-1)+"@string");l.push("]")}else{var h=o(d-1);var p=h in t?t[h]:e[h];l.push(m(p)?p+"@string":p)}n+=d-2;a()}else{throw new Error("Illegal express : "+r+"\nstep='analyseExpress',index="+n)}}}var v=0;for(var g=0;g<l.length;g++){if(["+","-"].indexOf(l[g])>-1&&(g==0||ne.indexOf(l[v-1])>-1)){l[v++]=+(l[g]+l[g+1]);g+=1}else{l[v++]=l[g]}}l.length=v;return l}var ae=function e(t){if(typeof t=="string")return t.replace(/@string$/,"");return t};var oe=function e(t){if(typeof t=="string")return t+"@string";return t};function le(e){var t=0,r=0;for(;r<e.length;r++){if(e[r]=="!"){e[t]=!e[++r]}else e[t]=e[r];t+=1}if(t==1)return ae(e[0]);e.length=t;t=0;for(r=0;r<e.length;r++){if(e[r]=="*"){e[t-1]=ae(e[t-1])*ae(e[++r])}else if(e[r]=="/"){e[t-1]=ae(e[t-1])/ae(e[++r])}else if(e[r]=="%"){e[t-1]=ae(e[t-1])%ae(e[++r])}else{e[t++]=e[r]}}if(t==1)return ae(e[0]);e.length=t;t=0;for(r=0;r<e.length;r++){if(e[r]=="+"){e[t-1]=oe(ae(e[t-1])+ae(e[++r]))}else if(e[r]=="-"){e[t-1]=ae(e[t-1])-ae(e[++r])}else e[t++]=e[r]}if(t==1)return ae(e[0]);e.length=t;t=0;for(r=0;r<e.length;r++){if(e[r]==">"){e[t-1]=ae(e[t-1])>ae(e[++r])}else if(e[r]=="<"){e[t-1]=ae(e[t-1])<ae(e[++r])}else if(e[r]=="<="){e[t-1]=ae(e[t-1])<=ae(e[++r])}else if(e[r]==">="){e[t-1]=ae(e[t-1])>=ae(e[++r])}else e[t++]=e[r]}if(t==1)return ae(e[0]);e.length=t;t=0;for(r=0;r<e.length;r++){if(e[r]=="=="){e[t-1]=ae(e[t-1])==ae(e[++r])}else if(e[r]=="==="){e[t-1]=ae(e[t-1])===ae(e[++r])}else if(e[r]=="!="){e[t-1]=ae(e[t-1])!=ae(e[++r])}else if(e[r]=="!=="){e[t-1]=ae(e[t-1])!==ae(e[++r])}else e[t++]=e[r]}if(t==1)return ae(e[0]);e.length=t;t=0;for(r=0;r<e.length;r++){if(e[r]=="&&"){e[t-1]=ae(e[t-1])&&ae(e[1+r]);r+=1}else if(e[r]=="||"){e[t-1]=ae(e[t-1])||ae(e[1+r]);r+=1}else e[t++]=e[r]}if(t==1)return ae(e[0]);e.length=t;t=0;for(r=0;r<e.length;r++){if(e[r]=="?"){e[t-1]=ae(e[t-1])?ae(e[r+1]):ae(e[r+3]);r+=3}else e[t++]=e[r]}if(t==1)return ae(e[0]);e.length=t;throw new Error("Unrecognized expression : ["+e.toString()+"]")}function se(t,r,n){var e=r[0]in n?n[r[0]]:t[r[0]];for(var i=1;i<r.length;i++){try{e=e[r[i]]}catch(e){console.error({target:t,scope:n,expressArray:r,index:i});throw e}}return e}var ue=function e(t,r,n){if(r.indexOf("(")>-1){var i=[],a=[],o=0;for(var l=0;l<r.length;l++){if(r[l]=="("){if(o>0){a.push("(")}o+=1}else if(r[l]==")"){if(o>1)a.push(")");o-=1;if(o==0){var s=le(e(t,a));i.push(m(s)?s+"@string":s);a=[]}}else{if(o>0)a.push(r[l]);else i.push(r[l])}}r=i}return fe(r)};var fe=function e(t){var r=true;while(r){r=false;var n=[],i=[],a=false;for(var o=0;o<t.length;o++){if(t[o]=="["&&o!=0&&t[o-1]!="]"){if(a){n.push("[");for(var l=0;l<i.length;l++){n.push(i[l])}}else{a=true}i=[]}else if(t[o]=="]"&&a){r=true;var s=le(i);var u=n[n.length-1][s];n[n.length-1]=m(u)?u+"@string":u;a=false}else{if(a){i.push(t[o])}else{n.push(t[o])}}}t=n}return t};var ce=function e(t){var r=[],n=[];for(var i=0;i<t.length;i++){if(t[i]=="["){n=[]}else if(t[i]=="]"){r.push(le(n))}else{n.push(t[i])}}return r};function de(e,t,r){var n=ue(e,t);var i;if(n[0]!="["){i=[le(n)]}else if(n[n.length-1]=="]"){i=ce(n)}else{var a=n.lastIndexOf("]");var o=ce(n.slice(0,a+1));var l=n.slice(a+1);l.unshift(se(e,o,r));i=[le(l)]}return i}var he=function e(t,r,n){if(arguments.length<3)n={};var i=ie(t,r,n);var a=de(t,i,n);if(a.length>1)throw new Error("Illegal expression : "+r+"\nstep='evalExpress',path="+a+",expressArray="+i);return a[0]};var pe=function e(t,r,n){if(r.animation&&t.value!=r.value){switch(r.type){case"number":{return{type:r.type,animation:true,value:(r.value-t.value)*n+t.value}}}}return r};function ve(c,d){var h={};for(var e=0;e<c.length;e++){var t={};for(var r=0;r<c[e].subAttr.length;r++){t[c[e].subAttr[r].id]=r}h[c[e].id]={index:e,subLinkIdToIndex:t}}return function(e){if(e==1)return d;var t=[];for(var r=0;r<d.length;r++){if(d[r].id in h){var n=c[h[d[r].id].index];var i={};for(var a in n.attr){i[a]=pe(n.attr[a],d[r].attr[a],e)}var o=[];for(var l=0;l<d[r].subAttr.length;l++){if(d[r].subAttr[l].id in h[d[r].id].subLinkIdToIndex){var s=n.subAttr[h[d[r].id].subLinkIdToIndex[d[r].subAttr[l].id]];var u={};for(var f in s.attr){u[f]=pe(s.attr[f],d[r].subAttr[l].attr[f],e)}o.push({id:s.id,name:s.name,subText:s.subText,subAttr:[],attr:u})}else{o.push(d[r].subAttr[l])}}t.push({id:d[r].id,name:d[r].name,subText:d[r].subText,subAttr:o,attr:i})}}return t}}function ge(e){e.prototype.$$updateView=function(){var f=this;if(!this._isMounted)return;this.$$lifecycle("beforeDraw");this.__regionManager.erase();this.__painter.clearRect();var e=function e(r){var n={_subTexts:f.__renderSeries[r].subText,_subAttr:[]};for(var t in f.__renderSeries[r].attr){n[t]=f.__renderSeries[r].attr[t].value}for(var i=0;i<f.__renderSeries[r].subAttr.length;i++){var a={series:f.__renderSeries[r].subAttr[i].name,attr:{}};for(var o in f.__renderSeries[r].subAttr[i].attr){a.attr[o]=f.__renderSeries[r].subAttr[i].attr[o].value}n._subAttr.push(a)}f.__defineSerirs[f.__renderSeries[r].name].link(f.__painter,n);var l=f.__defineSerirs[f.__renderSeries[r].name].region;if(l){var s=function e(t){l[t](function(e){e=e||"default";return f.__regionManager.painter(r+"@"+t+"::"+e)},n)};for(var u in l){s(u)}}};for(var t=0;t<this.__renderSeries.length;t++){e(t)}this.$$lifecycle("drawed")};e.prototype.$$updateWithSize=function(){this.$$lifecycle("beforeResize");var e=this.__el.clientWidth-(N(this.__el,"padding-left")+"").replace("px","")-(N(this.__el,"padding-right")+"").replace("px","");var t=this.__el.clientHeight-(N(this.__el,"padding-top")+"").replace("px","")-(N(this.__el,"padding-bottom")+"").replace("px","");this.__painter=Z(this.__canvas,e,t);this._width=e;this._height=t;this._max=e>t?e:t;this._min=e<t?e:t;this.__regionManager.updateSize(e,t);this.$$updateWithData(true);this.$$lifecycle("resized")};e.prototype.$$updateWithData=function(e){var t=this;if(x(this.__observeWatcher.stop)){this.__observeWatcher.stop()}else{this.$$lifecycle("beforeUpdate")}this.__events={click:{},dblclick:{},mousemove:{},mousedown:{},mouseup:{}};var b=[],_=this;(function e(t,r,n,i,a){var o=[];for(var l=0;l<t.length;l++){var s=i+t[l].index;for(var u in r){if(!(u in t[l].scope)){t[l].scope[u]=r[u]}}if(!a&&"c-for"in t[l]){var f=t[l]["c-for"];var c=he(_,f.data,t[l].scope);for(var d in c){t[l].scope[f.value]=c[d];if(f.key!=null)t[l].scope[f.key]=d;e([t[l]],{},false,s+"for"+d+"-",true)}continue}if("c-if"in t[l]&&!he(_,t[l]["c-if"],t[l].scope))continue;delete t[l]["c-if"];e(t[l].children,t[l].scope,false,s+"-",false);if(t[l].name!="group"){var h={name:t[l].name,attr:{},subAttr:[],subText:t[l].text,id:s};for(var p in t[l].attrs){var v=t[l].attrs[p];h.attr[p]={animation:v.animation,type:v.type,value:v.value.isBind?he(_,v.value.express,t[l].scope):v.value.express}}h.subAttr=e(t[l].subAttrs,t[l].scope,true,s+"-",false);for(var g=0;g<t[l].events.length;g++){var y=t[l].events[g];_.__events[y.event][b.length+"@"+y.region]=_[y.method]}if(n)o.push(h);else b.push(h)}t[l].scope={}}return o})(this.__renderAOP,{},false,"",false);if(!this.__renderSeries||e){this.__renderSeries=b;this.$$updateView();this.$$lifecycle("updated");return}var r=ve(this.__renderSeries,b);this.__observeWatcher.stop=w(function(e){t.__renderSeries=r(e);t.$$updateView()},500,function(e){if(e==1){t.__observeWatcher.stop=null;t.$$lifecycle("updated")}})}}function ye(n){var e=function e(t){var r=n.__data[t];n[t]=r;Object.defineProperty(n,t,{get:function e(){return r},set:function e(t){r=t;if(!n.__observeWatcher.flag){window.setTimeout(function(){n.$$updateWithData();n.__observeWatcher.flag=false},0)}n.__observeWatcher.flag=true}})};for(var t in n.__data){e(t)}}function be(t){if(!(this instanceof be)){console.error("Clunch is a constructor and should be called with the `new` keyword");return}["beforeCreate","created","beforeMount","mounted","beforeUnmount","unmounted","beforeUpdate","updated","beforeResize","resized","beforeDestroy","destroyed"].forEach(function(e){if(h(t[e])){t[e]=D(t[e])}});this.$$lifecycle(t.beforeCreate);this.$$init(t);ye(this);this.$$lifecycle("created");if(p(t.el)){this.$mount(t.el)}}Q(be);ee(be);ge(be);be.prototype.__defineSerirs={};function _e(t){try{t.__observeResize.observer=new ResizeObserver(function(){if(!t.__observeResize.flag){t.__observeResize.flag=true;var e=setInterval(function(){if(t.__observeResize.help){window.clearInterval(e);t.__observeResize.flag=false;t.$$updateWithSize()}t.__observeResize.help=true},200)}else{t.__observeResize.help=false}});t.__observeResize.observer.observe(t.__el)}catch(e){t.$$updateWithSize();console.error("ResizeObserver undefined!")}}function me(e){var t=D(e);for(var r in t.attrs){if(x(t.attrs[r])){t.attrs[r]=t.attrs[r](false)}}for(var n in t.subAttrs){for(var i in t.subAttrs[n]){if(x(t.subAttrs[n][i])){t.subAttrs[n][i]=t.subAttrs[n][i](false)}}}return t}function xe(n){n.series=function(e,t){if(arguments.length==1){for(var r in e){n.series(r,e[r])}}else{if(x(n.prototype.__defineSerirs[e])){console.warn("The series["+e+"] has been registered!")}n.prototype.__defineSerirs[e]=me(t)}return n}}xe(be);be.prototype.$mount=function(e){var u=this;if(this._isDestroyed){console.warn("The clunch has been destroyed!");return}if(this._isMounted){console.warn("The clunch is already mounted!");return}if(!p(e)){console.warn("Mount node does not exist!");return}this.$$lifecycle("beforeMount");if(!this.__renderFlag){this.__renderOptions=this.$$templateCompiler(e.innerHTML);this.__renderAOP=L(this.__renderOptions,this.__defineSerirs)}this.__el=e;e.innerHTML="<canvas>ÈùûÂ∏∏Êä±Ê≠âÔºåÊÇ®ÁöÑÊµèËßàÂô®‰∏çÊîØÊåÅcanvas!</canvas>";this.__canvas=e.getElementsByTagName("canvas")[0];_e(this);this.$$updateWithData();["click","dblclick","mousemove","mousedown","mouseup"].forEach(function(s){H(u.__canvas,s,function(e){var t=u.__regionManager.getRegion(e);if(t[0]!=null){var r=t[0].split("::");var n=u.__events[s][r[0]];if(x(n)){var i=r[0].split("@");var a=u.__renderSeries[i[0]];var o={};for(var l in a.attr){o[l]=a.attr[l].value}n.call(u,{series:a.name,region:i[1],subRegion:r[1],attr:o,left:t[1],top:t[2]})}}})});this.$bind=function(e,s){var u=this;H(this.__canvas,e,function(e){var t=u.__regionManager.getRegion(e);var r;if(t[0]!=null){var n=t[0].split("::");var i=n[0].split("@");var a=u.__renderSeries[i[0]];var o={};for(var l in a.attr){o[l]=a.attr[l].value}r={series:a.name,region:i[1],subRegion:n[1],attr:o}}else{r={series:null,region:null,subRegion:null,attr:{}}}r.left=t[1];r.top=t[2];s.call(u,r)});return this};this._isMounted=true;this.$$lifecycle("mounted");return this};be.prototype.$unmount=function(){};be.prototype.$destroy=function(){};be.series("group",[function(){return{attrs:{}}}]);function we(a){var o={},l=0;a=a.trim();var e=function e(){var t="",r="";for(;l<a.length;l++){if(te.blanksReg.test(a[l])||l==a.length-1){t+=a[l];if(!te.blanksReg.test(t)){o[t.trim()]=""}l+=1;break}else if(a[l]=="="){l+=1;var n=null,i=-1;if(a.substr(l,1)=='"'||a.substr(l,1)=="'"){n=a.substr(l,1);i=1;l+=1}else if(a.substr(l,2)=='"'||a.substr(l,2)=="'"){n=a.substr(l,2);i=2;l+=2}if(n!==null){for(;l<a.length;l++){if(a.substr(l,i)==n){o[t.trim()]=r.trim();l+=2;break}else{r+=a[l]}}}else{for(;l<a.length;l++){if(te.blanksReg.test(a[l])){o[t.trim()]=r.trim();l+=1;break}else{r+=a[l]}}}break}else{t+=a[l]}}if(l<a.length){e()}};e();return o}function ke(s){var u=-1,f=null;var c=false,d="";var h=["script","pre","style","code"];var p=function e(){f=u++<s.length-1?s[u]:null;return f};var v=function e(t){return s.substring(u,t+u>s.length?s.length:t+u)};p();while(te.blankReg.test(f)&&u<s.length-1){p()}return function(){var e=f,t={};if(e==null)return null;if(c){t.type="textcode";t.tagName=e;while(v(d.length+3)!="</"+d+">"&&u<s.length){t.tagName+=p()}t.tagName=t.tagName.replace(/<$/,"");c=false;return t}if(v(4)=="\x3c!--"){t.type="comment";t.tagName=e;while(v(3)!="--\x3e"&&u<s.length){t.tagName+=p()}p();p();p();t.tagName=t.tagName.replace(/^<!--/,"").replace(/-$/,"");return t}if(v(9)=="<!DOCTYPE"){t.type="DOCTYPE";t.tagName=e;while(v(1)!=">"&&u<s.length){t.tagName+=p()}p();t.tagName=t.tagName.replace(/^<!DOCTYPE/,"").replace(/>$/,"");return t}else if(e=="<"){var r=false,n=null,i=null;while(r||f!=">"&&u<s.length){e+=p();if(r){var a=v(i+1).substring(1);if(a==n){r=false}}else{var a=v(2);if(a=='="'||a=="='"){n=a.replace("=","");i=1;r=true}a=v(3);if(a=='="'||a=="='"){n=a.replace("=","");i=2;r=true}}}if(/^<\//.test(e)){t.tagName=e.replace(/^<\//,"").replace(/>$/,"");t.type="endTag"}else{if(/\/>$/.test(e)){t.type="fullTag";e=e.replace(/\/>$/,"")}else{t.type="beginTag";e=e.replace(/>$/,"")}e=e.replace(/^</,"");t.tagName="";var o=0;for(;o<e.length;o++){if(e[o]==" ")break;t.tagName+=e[o]}var l=e.substring(o);if(te.blanksReg.test(l)){t.attrs={}}else{t.attrs=we(l)}}}else{t.type="textcode";t.tagName=f;while(v(1)!="<"&&u<s.length){t.tagName+=p()}t.tagName=t.tagName.replace(/<$/,"");u-=1}if(t.type=="beginTag"){if(h.indexOf(t.tagName.toLowerCase())>-1){c=true;d=t.tagName}}else if(t.type=="endTag"){if(h.indexOf(t.tagName.toLowerCase())>-1){c=false}}p();return t}}function $e(e){e=Te(e);var t=0,r=[];e.forEach(function(e){if(e.type=="beginTag"){r.push({type:"tag",name:e.tagName,attrs:e.attrs,__deep__:++t,__tagType__:"double"})}else if(e.type=="endTag"){t-=1}else if(e.type=="textcode"){r.push({type:"text",content:e.tagName,__deep__:t+1})}else if(e.type=="comment"){r.push({type:"comment",content:e.tagName,__deep__:t+1})}else{r.push({type:"tag",name:e.tagName,attrs:e.attrs,__deep__:t+1,__tagType__:"single"})}});return r}var Te=function e(n){var i=[];n.forEach(function(e,t){if(e.type=="beginTag"){i.push([t,e.tagName])}else if(e.type=="endTag"){while(i.length>0){var r=i.pop();if(r[1]==e.tagName){break}else{n[r[0]].type="fullTag"}}}});return n};function Ae(e,t){if(!m(e))throw new Error("Template must be a String!");var r=ke(e.trim());var n=r(),i=[];while(n!=null){if(n.type=="textcode"&&te.blanksReg.test(n.tagName));else if(n.type=="DOCTYPE");else if(n.type=="comment"){if(t){i.push(n)}}else{i.push(n)}n=r()}i=$e(i);var a=[null],o=0;for(var l=0;l<i.length;l++){var s=l,u=i[l].__deep__;i[l].childNodes=[];i[l].preNode=null;i[l].nextNode=null;var f=a[a.length-1];var c=a.length>1?a[a.length-2]:null;if(u==o){i[s].preNode=f;i[f].nextNode=s;i[s].parentNode=c;i[c].childNodes.push(s);a[a.length-1]=s}else if(u>o){i[s].parentNode=f;if(f!=null)i[f].childNodes.push(s);a.push(s)}else{var d=a[a.length-1-(o-u)];var h=a[a.length-2-(o-u)];i[s].preNode=d;if(d!=null)i[d].nextNode=s;i[s].parentNode=h;if(h!=null)i[h].childNodes.push(s);for(var p=0;p<o-u;p++){a.pop()}a[a.length-1]=s}o=u}return i}function Se(e){var a=Ae("<clunch>"+e+"</clunch>");return function e(t){var r=[];for(var n=0;n<t.childNodes.length;n++){var i=a[t.childNodes[n]];if(i.type=="tag"){r.push({name:i.name,attrs:i.attrs,children:e(i)})}else{r.push(i.content.trim())}}return r}(a[0])}var Re=["number","json","string","color",function(e,t,r,n){return{attrs:{"fill-color":n("black"),"stroke-color":n("black"),"line-width":e(1)(true),dash:t([]),type:r("fill"),cx:e()(true),cy:e()(true),radius1:e()(true),radius2:e()(true),begin:e(0)(true),deg:e()(true)},region:{default:function e(t,r){t().config({lineWidth:r["line-width"],lineDash:r.dash})[r.type+"Arc"](r.cx,r.cy,r.radius1,r.radius2,r.begin,r.deg)}},link:function e(t,r){t.config({fillStyle:r["fill-color"],strokeStyle:r["stroke-color"],lineWidth:r["line-width"],lineDash:r.dash});var n=r.type;if(x(t[n+"Arc"])){t[n+"Arc"](r.cx,r.cy,r.radius1,r.radius2,r.begin,r.deg)}else{throw new Error("Type error!"+JSON.stringify({series:"arc",type:n}))}}}}];var Ne=["number","json","string","color",function(e,t,r,n){return{attrs:{"fill-color":n("black"),"stroke-color":n("black"),"line-width":e(1),dash:t([]),type:r("fill"),cx:e()(true),cy:e()(true),radius:e()(true)},region:{default:function e(t,r){t().config({lineWidth:r["line-width"],lineDash:r.dash})[r.type+"Circle"](r.cx,r.cy,r.radius)}},link:function e(t,r){t.config({fillStyle:r["fill-color"],strokeStyle:r["stroke-color"],lineWidth:r["line-width"],lineDash:r.dash});var n=r.type;if(x(t[n+"Circle"])){t[n+"Circle"](r.cx,r.cy,r.radius)}else{throw new Error("Type error!"+JSON.stringify({series:"circle",type:n}))}}}}];var Oe=["number","string","boolean","json","color",function(e,t,r,n,i){return{attrs:{"fill-color":i("black"),"stroke-color":i("black"),"line-width":e(1)(true),dash:n([]),type:t("stroke"),close:r(false)},subAttrs:{"move-to":{x:e()(true),y:e()(true)},"line-to":{x:e()(true),y:e()(true)},"bezier-to":{x:e()(true),y:e()(true),cp1x:e()(true),cp1y:e()(true),cp2x:e(null)(true),cp2y:e(null)(true)}},link:function e(t,r){t.config({fillStyle:r["fill-color"],strokeStyle:r["stroke-color"],lineWidth:r["line-width"],lineDash:r.dash});t.beginPath();for(var n=0;n<r._subAttr.length;n++){if(r._subAttr[n].series=="move-to"){t.moveTo(r._subAttr[n].attr.x,r._subAttr[n].attr.y)}else if(r._subAttr[n].series=="line-to"){t.lineTo(r._subAttr[n].attr.x,r._subAttr[n].attr.y)}else if(r._subAttr[n].series=="bezier-to"){if(r._subAttr[n].attr.cp2x==null&&r._subAttr[n].attr.cp2y==null){t.quadraticCurveTo(r._subAttr[n].attr.cp1x,r._subAttr[n].attr.cp1y,r._subAttr[n].attr.x,r._subAttr[n].attr.y)}else{t.bezierCurveTo(r._subAttr[n].attr.cp1x,r._subAttr[n].attr.cp1y,r._subAttr[n].attr.cp2x,r._subAttr[n].attr.cp2y,r._subAttr[n].attr.x,r._subAttr[n].attr.y)}}}if(r.close)t.closePath();var i=r.type;if(x(t[i])){t[i]()}else{throw new Error("Type error!"+JSON.stringify({series:"path",type:i}))}}}}];var Pe=["number","json","string","color","$rotate",function(e,t,r,n,d){return{attrs:{begin:e(0),deg:e(Math.PI*2),color:n("black"),cx:e(),cy:e(),radius:e(),"mark-direction":r("outer"),"value-position":r("mark"),value:t()},link:function e(t,r){var n=r.value;t.config({lineWidth:1,fillStyle:r.color,strokeStyle:r.color,"font-size":"12",textAlign:"center",textBaseline:"middle",lineDash:[]});t.beginPath().arc(r.cx,r.cy,r.radius,r.begin,r.deg).stroke();var i=r["value-position"]=="mark"?n.length:n.length+1;var a=r.deg/(i-1);for(var o=0;o<i;o++){var l,s;(l=(s=t.beginPath()).moveTo.apply(s,v(d(r.cx,r.cy,r.begin+o*a,r.cx+r.radius,r.cy)))).lineTo.apply(l,v(d(r.cx,r.cy,r.begin+o*a,r.cx+r.radius+5*(r["mark-direction"]=="inner"?-1:1),r.cy))).stroke()}for(var u=0;u<n.length;u++){var f=r.begin+a*(u+(r["value-position"]=="mark"?0:.5));var c=f%(Math.PI*2);t.fillText.apply(t,[n[u]].concat(v(d(r.cx,r.cy,f,r.cx+r.radius+15*(r["mark-direction"]=="inner"?-1:1),r.cy)),[f+(c>0&&c<Math.PI||c>-2*Math.PI&&c<-Math.PI?-Math.PI*.5:Math.PI*.5)]))}}}}];var ze=["number","json","string","color",function(e,t,r,n){return{attrs:{"fill-color":n("black"),"stroke-color":n("black"),"line-width":e(1),dash:t([]),type:r("fill"),align:r("left"),baseline:r("top"),x:e()(true),y:e()(true),width:e()(true),height:e()(true)},region:{default:function e(t,r){t().config({lineWidth:r["line-width"],lineDash:r.dash})[r.type+"Rect"](r.x,r.y,r.width,r.height)}},link:function e(t,r){if(r.align=="center")r.x-=r.width*.5;else if(r.align=="right")r.x-=r.width;if(r.baseline=="middle")r.y-=r.height*.5;else if(r.baseline=="bottom")r.y-=r.height;t.config({fillStyle:r["fill-color"],strokeStyle:r["stroke-color"],lineWidth:r["line-width"],lineDash:r.dash});var n=r.type;if(x(t[n+"Rect"])){t[n+"Rect"](r.x,r.y,r.width,r.height)}else{throw new Error("Type error!"+JSON.stringify({series:"rect",type:n}))}}}}];var Ee=["number","json","string","color","$dot",function(e,t,r,n,p){return{attrs:{x:e(),y:e(),direction:r("LR"),length:e(),"mark-direction":r("right"),"value-position":r("mark"),color:n("black"),value:t()},link:function e(t,r){var n=r.value;t.config({lineWidth:1,fillStyle:r.color,strokeStyle:r.color,"font-size":"12",textAlign:r.direction=="LR"||r.direction=="RL"?"center":r.direction=="BT"&&r["mark-direction"]=="right"||r.direction=="TB"&&r["mark-direction"]=="left"?"left":"right",lineDash:[],textBaseline:"middle"});var i;var a;if(r.direction=="LR"){i={x:r.x+r.length,y:r.y};a=r["mark-direction"]=="right"?[0,1]:[0,-1]}else if(r.direction=="RL"){i={x:r.x-r.length,y:r.y};a=r["mark-direction"]=="right"?[0,-1]:[0,1]}else if(r.direction=="TB"){i={x:r.x,y:r.y+r.length};a=r["mark-direction"]=="right"?[-1,0]:[1,0]}else if(r.direction=="BT"){i={x:r.x,y:r.y-r.length};a=r["mark-direction"]=="right"?[1,0]:[-1,0]}else{throw new Error("Type error!"+JSON.stringify({series:"ruler",type:type}))}t.beginPath().moveTo(r.x,r.y).lineTo(i.x,i.y).stroke();var o=r["value-position"]=="mark"?n.length:n.length+1;var l=r.length/(o-1);var s=p({d:[i.x-r.x,i.y-r.y],p:[r.x,r.y]});for(var u=0;u<o;u++){var f;var c=s.value();(f=t.beginPath()).moveTo.apply(f,v(c)).lineTo(c[0]+a[0]*5,c[1]+a[1]*5).stroke();s.move(l)}s=p({d:[i.x-r.x,i.y-r.y],p:[r.x,r.y]});if(r["value-position"]=="between")s.move(l*.5);for(var d=0;d<n.length;d++){var h=s.value();t.fillText(n[d],h[0]+a[0]*15,h[1]+a[1]*15);s.move(l)}}}}];var Me=["number","string","json","color",function(e,t,r,n){return{attrs:{"fill-color":n("black"),"stroke-color":n("black"),"font-size":e(16)(true),"font-family":t("sans-serif"),"line-width":e(1),align:t("left"),baseline:t("middle"),type:t("fill"),content:t(null),x:e()(true),y:e()(true),deg:e(0)(true),dash:r([])},region:{default:function e(t,r){t().config({"font-size":r["font-size"],"font-family":r["font-family"],lineWidth:r["line-width"],textAlign:r["align"],textBaseline:r["baseline"],lineDash:r.dash})[r.type+"Text"]((r.content+"").trim(),r.x,r.y,r.deg)}},link:function e(t,r){if(r.content==null){r.content=r._subTexts.join("\n")}t.config({fillStyle:r["fill-color"],strokeStyle:r["stroke-color"],"font-size":r["font-size"],"font-family":r["font-family"],lineWidth:r["line-width"],textAlign:r["align"],textBaseline:r["baseline"],lineDash:r.dash});var n=r.type;if(x(t[n+"Text"])){t[n+"Text"]((r.content+"").trim(),r.x,r.y,r.deg)}else{throw new Error("Type error!"+JSON.stringify({series:"text",type:n}))}}}}];be.prototype.$$templateCompiler=Se;be.series({arc:Re,circle:Ne,path:Oe,"polar-ruler":Pe,rect:ze,ruler:Ee,text:Me});if((typeof module==="undefined"?"undefined":n(module))==="object"&&n(module.exports)==="object"){module.exports=be}else{window.Clunch=be}})();