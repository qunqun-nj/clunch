/*!
 * clunch.js <@template> - 🎨 The Progressive JavaScript Interactive Picture Framework.
 * git+https://github.com/hai2007/clunch.git
 *
 * author hai2007 < https://hai2007.gitee.io/sweethome >
 *
 * version 0.1.0-alpha.1
 *
 * Copyright (c) 2020 hai2007 走一步，再走一步。
 * Released under the MIT license
 *
 * Date:Thu Nov 26 2020 16:23:28 GMT+0800 (GMT+08:00)
 */
(function(){"use strict";function n(e){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){n=function(e){return typeof e}}else{n=function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return n(e)}function g(e){return t(e)||r(e)||i(e)||a()}function t(e){if(Array.isArray(e))return o(e)}function r(e){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(e))return Array.from(e)}function i(e,t){if(!e)return;if(typeof e==="string")return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor)r=e.constructor.name;if(r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}function o(e,t){if(t==null||t>e.length)t=e.length;for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e){var t=n(e);return e!=null&&(t==="object"||t==="function")}var u=Object.prototype.toString;function s(e){if(e==null){return e===undefined?"[object Undefined]":"[object Null]"}return u.call(e)}function e(e){var t=n(e);return t==="string"||t==="object"&&e!=null&&!Array.isArray(e)&&s(e)==="[object String]"}function c(e){if(!l(e)){return false}var t=s(e);return t==="[object Function]"||t==="[object AsyncFunction]"||t==="[object GeneratorFunction]"||t==="[object Proxy]"}function f(e){if(e===null||n(e)!=="object"||s(e)!="[object Object]"){return false}if(Object.getPrototypeOf(e)===null){return true}var t=e;while(Object.getPrototypeOf(t)!==null){t=Object.getPrototypeOf(t)}return Object.getPrototypeOf(e)===t}var d=function e(t,r){return r!==null&&n(r)==="object"&&t.indexOf(r.nodeType)>-1&&!f(r)};var y=e;var w=c;var h=function e(t){return Array.isArray(t)};var p=function e(t){return d([1,9,11],t)};var v=[];var b=13;var m=400;var x=null;function _(t,e,r){var u={timer:function e(t,r,n){if(!t){throw new Error("Tick is required!")}r=r||m;var i=(new Date).valueOf()+"_"+(Math.random()*1e3).toFixed(0);v.push({id:i,createTime:new Date,tick:t,duration:r,callback:n});u.start();return i},start:function e(){if(!x){x=setInterval(u.tick,b)}},tick:function e(){var t,r,e,n,i,o,a,l=v;v=[];v.length=0;for(r=0;r<l.length;r++){i=l[r];t=i.createTime;e=i.tick;o=i.duration;n=i.callback;a=(+new Date-t)/o;a=a>1?1:a;e(a);if(a<1&&i.id){v.push(i)}else if(n){n(a)}}if(v.length<=0){u.stop()}},stop:function e(){if(x){clearInterval(x);x=null}}};var n=u.timer(function(e){t(e)},e,r);return function(){var e;for(e in v){if(v[e].id==n){v[e].id=undefined;return}}}}var k=function e(t,r){for(var n in r){try{t[n]=r[n]}catch(e){throw new Error("Illegal property value！")}}return t};var T={whitespace:"[\\x20\\t\\r\\n\\f]"};var $=function e(t){if(/^[_$]/.test(t)){console.warn("The beginning of _ or $ is not allowed："+t)}};function N(e,t){for(var r in t){try{e[r]=t[r]}catch(e){throw new Error("Illegal property value！")}}return e}function A(u){u=N({u:.5},u);var s,c,f;var d=function e(t){if(s){var r=(t-c)/(f-c),n=r*r,i=r*n;var o=i*s[0]+n*s[1]+r*s[2]+s[3];return o*(f-c)}else throw new Error("You shoud first set the position!")};d.setP=function(e,t,r,n,i,o){if(e<r){c=e;f=r;var a=u.u*i,l=u.u*o;t/=r-e;n/=r-e;s=[2*t-2*n+a+l,3*n-3*t-2*a-l,a,t]}else throw new Error("The point x-position should be increamented!");return d};return d}function S(i){i=k({t:0},i);var o,r;var a=function e(t){if(o){r=-1;while(r+1<o.x.length&&(t>o.x[r+1]||r==-1&&t>=o.x[r+1])){r+=1}if(r==-1||r>=o.h.length)throw new Error("Coordinate crossing!");return o.h[r](t)}else{throw new Error("You shoud first set the position!")}};a.setT=function(e){if(typeof e==="number"){i.t=e}else{throw new Error("Expecting a figure!")}return a};a.setP=function(e){o={x:[],h:[]};var t,r=(e[1][1]-e[0][1])/(e[1][0]-e[0][0]),n;o.x[0]=e[0][0];for(t=1;t<e.length;t++){if(e[t][0]<=e[t-1][0])throw new Error("The point position should be increamented!");o.x[t]=e[t][0];n=t<e.length-1?(e[t+1][1]-e[t-1][1])/(e[t+1][0]-e[t-1][0]):(e[t][1]-e[t-1][1])/(e[t][0]-e[t-1][0]);o.h[t-1]=A({u:(1-i.t)*.5}).setP(e[t-1][0],e[t-1][1],e[t][0],e[t][1],r,n);r=n}return a};return a}function j(e,t){var r=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(e,null):e.currentStyle;return y(t)?r.getPropertyValue(t):r}var O=function e(t){var r=document.getElementsByTagName("head")[0];r.style["color"]=t;var n=j(r,"color");var i=n.replace(/^rgba?\(([^)]+)\)$/,"$1").split(new RegExp("\\,"+T.whitespace));return[+i[0],+i[1],+i[2],i[3]==undefined?1:+i[3]]};var E=function e(t,r){if(!(r&&r>=0&&r<=1))r=1;var n=[];for(var i=1;i<=t;i++){n.push("rgba("+(Math.random(1)*230+20).toFixed(0)+","+(Math.random(1)*230+20).toFixed(0)+","+(Math.random(1)*230+20).toFixed(0)+","+r+")")}return n};function P(e){var s=e||{},c,n;var i=function e(){var a=[],l=0,u=0;(function e(t,r){if(r>u)u=r;var n;for(n=0;n<t.children.length;n++){e(c[t.children[n]],r+1)}c[t.id].left=r+.5;if(n==0){if(a[r]==undefined)a[r]=-.5;if(a[r-1]==undefined)a[r-1]=-.5;c[t.id].top=a[r]+1;var i=a[r]+1+(c[t.pid].children.length-1)*.5;if(i-1<a[r-1])c[t.id].top=a[r-1]+1-(c[t.pid].children.length-1)*.5}else{c[t.id].top=(c[t.children[0]].top+c[t.children[n-1]].top)*.5}if(c[t.id].top<=a[r]){var o=a[r]+1-c[t.id].top;(function e(t,r){c[t].top+=o;if(a[r]<c[t].top)a[r]=c[t].top;var n;for(n=0;n<c[t].children.length;n++){e(c[t].children[n],r+1)}})(t.id,r)}a[r]=c[t.id].top;if(c[t.id].top+.5>l)l=c[t.id].top+.5})(c[n],0);return{node:c,root:n,size:l,deep:u+1}};var o=function e(o){var a={};var t=s.root(o),l,r;l=r=s.id(t);a[l]={data:t,pid:null,id:l,children:[]};var u=1;(function e(t,r){var n=s.child(t,o),i;u+=n?n.length:0;for(i=0;n&&i<n.length;i++){l=s.id(n[i]);a[r].children.push(l);a[l]={data:n[i],pid:r,id:l,children:[]};e(n[i],l)}})(t,l);return{value:[r,a],num:u}};var t=function e(t){var r=o(t);c=r.value[1];n=r.value[0];if(r.num==1){c[n].left=.5;c[n].top=.5;return{deep:1,node:c,root:n,size:1}}return i()};t.root=function(e){s.root=e;return t};t.child=function(e){s.child=e;return t};t.id=function(e){s.id=e;return t};return t}var M=function e(t,r,n,i,o){var a=Math.cos(n),l=Math.sin(n);return[+((i-t)*a-(o-r)*l+t).toFixed(7),+((i-t)*l+(o-r)*a+r).toFixed(7)]};var R=function e(t,r,n,i,o){var a=Math.sqrt(t*t+r*r);return[+(t*n/a+i).toFixed(7),+(r*n/a+o).toFixed(7)]};var C=function e(t,r,n,i,o){return[+(n*(i-t)+t).toFixed(7),+(n*(o-r)+r).toFixed(7)]};var z=function e(o){o=k({d:[1,1],c:[0,0],p:[0,0]},o);var a={rotate:function e(t){var r=o.d[0]+o.p[0],n=o.d[1]+o.p[1];var i=M(o.p[0],o.p[1],t,r,n);o.d=[i[0]-o.p[0],i[1]-o.p[1]];return a},move:function e(t){o.p=R(o.d[0],o.d[1],t,o.p[0],o.p[1]);return a},scale:function e(t){o.p=C(o.c[0],o.c[1],t,o.p[0],o.p[1]);return a},value:function e(){return o.p}};return a};function D(m){m=k({"begin-deg":0,deg:Math.PI*2},m);var x=P().root(m.root).child(m.child).id(m.id);var t=function e(t){var r=x(t);for(var n in r.node){r.node[n].deep=r.node[n].left-.5}if(m.type==="LR"||m.type==="RL"){var i=m.width/r.deep;if("RL"===m.type)i*=-1;var o=m.height/(r.size- -.5);for(var a in r.node){var l=r.node[a];r.node[a].left=+(("RL"==m.type?m.width:0)- -l.left*i).toFixed(7);r.node[a].top=+(l.top*o).toFixed(7)}}else if(m.type==="TB"||m.type==="BT"){var u=m.height/r.deep;if("BT"==m.type)u*=-1;var s=m.width/(r.size- -.5);var c,f;for(var d in r.node){var h=r.node[d];c=h.left;f=h.top;r.node[d].top=+(("BT"==m.type?m.height:0)- -c*u).toFixed(7);r.node[d].left=+(f*s).toFixed(7)}}else if(m.type==="circle"){if(r.deep==1&&r.size==1){r.node[r.root].left=m.cx;r.node[r.root].top=m.cy}else{var p=m.radius/(r.deep-1);var g=m.deg/(r.size- -.5);for(var y in r.node){var v=r.node[y];r.node[y].deg=(m["begin-deg"]- -g*v.top)%(Math.PI*2);var b=M(m.cx,m.cy,r.node[y].deg,m.cx- -p*(v.left-.5),m.cy);r.node[y].left=+b[0];r.node[y].top=+b[1]}}}if(w(m.drawer)){m.drawer(r);return e}else{return r}};t.config=function(e){m=k(m,e);return t};t.drawer=function(e){m.drawer=e;return t};return t}function F(i){var t=[];var e=function e(n){if(["boolean","number","json","string","color","any"].indexOf(i[n])>-1){t.unshift(function(t){var r=arguments.length>0?false:true;return function(e){return{type:i[n],required:r,animation:e,default:t}}})}else{t.unshift({$animation:_,$cardinal:S,$formatColor:O,$getRandomColors:E,$tree:D,$dot:z,$rotate:M,$move:R,$scale:C}[i[n]])}};for(var r=i.length-2;r>=0;r--){e(r)}return i[i.length-1].apply(this,t)}function I(e){e.prototype.$$init=function(e){this.__options=e;this.__data=h(e.data)?F(e.data):w(e.data)?e.data():e.data;this._isMounted=false;this._isDestroyed=false;for(var t in e.methods){$(t);this[t]=h(e.methods[t])?F(e.methods[t]):e.methods[t]}for(var r in this.__data){$(r);this[r]=this.__data[r]}}}function B(e){e.prototype.$$lifecycle=function(e){if(w(e)){e()}else{if(["created","beforeMount","mounted","beforeUnmount","unmounted","beforeUpdate","updated","beforeResize","resized","beforeDestroy","destroyed"].indexOf(e)>-1&&w(this.__options[e])){this.__options[e].call(this)}}return this}}function L(n){var e=function e(t){var r=n.__data[t];n[t]=r;Object.defineProperty(n,t,{get:function e(){return r},set:function e(t){r=t;n.$$lifecycle("beforeUpdate");n.$$lifecycle("updated")}})};for(var t in n.__data){e(t)}}function W(t){if(!(this instanceof W)){console.error("[Clunch error]: Clunch is a constructor and should be called with the `new` keyword");return}["beforeCreate","created","beforeMount","mounted","beforeUnmount","unmounted","beforeUpdate","updated","beforeResize","resized","beforeDestroy","destroyed"].forEach(function(e){if(h(t[e])){t[e]=F(t[e])}});this.$$lifecycle(t.beforeCreate);this.$$init(t);L(this);this.$$lifecycle("created");if(p(t.el)){this.$mount(t.el)}}I(W);B(W);W.prototype.__defineSerirs={};function U(e){var t=F(e);for(var r in t.attrs){if(w(t.attrs[r])){t.attrs[r]=t.attrs[r](false)}}for(var n in t.subAttrs){for(var i in t.subAttrs[n]){if(w(t.subAttrs[n][i])){t.subAttrs[n][i]=t.subAttrs[n][i](false)}}}return t}function J(n){n.series=function(e,t){if(arguments.length==1){for(var r in e){n.series(r,e[r])}}else{if(w(n.prototype.__defineSerirs[e])){console.warn("The series["+e+"] has been registered!")}n.prototype.__defineSerirs[e]=U(t)}return n}}J(W);W.prototype.$mount=function(e){if(this._isDestroyed){console.warn("The clunch has been destroyed!");return}if(this._isMounted){console.warn("The clunch is already mounted!");return}if(!p(e)){console.warn("Mount node does not exist!");return}this.$$lifecycle("beforeMount");this.__el=e;e.innerHTML="<canvas>非常抱歉，您的浏览器不支持canvas!</canvas>";this.__canvas=e.getElementsByTagName("canvas")[0];this._isMounted=true;this.$$lifecycle("mounted");return this};W.prototype.$unmount=function(){};W.prototype.$destroy=function(){};var Y={blankReg:new RegExp("[\\x20\\t\\r\\n\\f]"),blanksReg:/^[\x20\t\r\n\f]{0,}$/,identifier:/^[a-zA-Z_$][0-9a-zA-Z_$]{0,}$/};function q(o){var a={},l=0;o=o.trim();var e=function e(){var t="",r="";for(;l<o.length;l++){if(Y.blanksReg.test(o[l])||l==o.length-1){t+=o[l];if(!Y.blanksReg.test(t)){a[t.trim()]=""}l+=1;break}else if(o[l]=="="){l+=1;var n=null,i=-1;if(o.substr(l,1)=='"'||o.substr(l,1)=="'"){n=o.substr(l,1);i=1;l+=1}else if(o.substr(l,2)=='"'||o.substr(l,2)=="'"){n=o.substr(l,2);i=2;l+=2}if(n!==null){for(;l<o.length;l++){if(o.substr(l,i)==n){a[t.trim()]=r.trim();l+=2;break}else{r+=o[l]}}}else{for(;l<o.length;l++){if(Y.blanksReg.test(o[l])){a[t.trim()]=r.trim();l+=1;break}else{r+=o[l]}}}break}else{t+=o[l]}}if(l<o.length){e()}};e();return a}function V(s){var c=-1,f=null;var d=false,h="";var p=["script","pre","style","code"];var g=function e(){f=c++<s.length-1?s[c]:null;return f};var y=function e(t){return s.substring(c,t+c>s.length?s.length:t+c)};g();while(Y.blankReg.test(f)&&c<s.length-1){g()}return function(){var e=f,t={};if(e==null)return null;if(d){t.type="textcode";t.tagName=e;while(y(h.length+3)!="</"+h+">"&&c<s.length){t.tagName+=g()}t.tagName=t.tagName.replace(/<$/,"");d=false;return t}if(y(4)=="\x3c!--"){t.type="comment";t.tagName=e;while(y(3)!="--\x3e"&&c<s.length){t.tagName+=g()}g();g();g();t.tagName=t.tagName.replace(/^<!--/,"").replace(/-$/,"");return t}if(y(9)=="<!DOCTYPE"){t.type="DOCTYPE";t.tagName=e;while(y(1)!=">"&&c<s.length){t.tagName+=g()}g();t.tagName=t.tagName.replace(/^<!DOCTYPE/,"").replace(/>$/,"");return t}else if(e=="<"){var r=false,n=null,i=null;while(r||f!=">"&&c<s.length){e+=g();if(r){var o=y(i+1).substring(1);if(o==n){r=false}}else{var a=y(2);if(a=='="'||a=="='"){n=a.replace("=","");i=1;r=true}a=y(3);if(a=='="'||a=="='"){n=a.replace("=","");i=2;r=true}}}if(/^<\//.test(e)){t.tagName=e.replace(/^<\//,"").replace(/>$/,"");t.type="endTag"}else{if(/\/>$/.test(e)){t.type="fullTag";e=e.replace(/\/>$/,"")}else{t.type="beginTag";e=e.replace(/>$/,"")}e=e.replace(/^</,"");t.tagName="";var l=0;for(;l<e.length;l++){if(e[l]==" ")break;t.tagName+=e[l]}var u=e.substring(l);if(Y.blanksReg.test(u)){t.attrs={}}else{t.attrs=q(u)}}}else{t.type="textcode";t.tagName=f;while(y(1)!="<"&&c<s.length){t.tagName+=g()}t.tagName=t.tagName.replace(/<$/,"");c-=1}if(t.type=="beginTag"){if(p.indexOf(t.tagName.toLowerCase())>-1){d=true;h=t.tagName}}else if(t.type=="endTag"){if(p.indexOf(t.tagName.toLowerCase())>-1){d=false}}g();return t}}function Z(e){e=G(e);var t=0,r=[];e.forEach(function(e){if(e.type=="beginTag"){r.push({type:"tag",name:e.tagName,attrs:e.attrs,__deep__:++t,__tagType__:"double"})}else if(e.type=="endTag"){t-=1}else if(e.type=="textcode"){r.push({type:"text",content:e.tagName,__deep__:t+1})}else if(e.type=="comment"){r.push({type:"comment",content:e.tagName,__deep__:t+1})}else{r.push({type:"tag",name:e.tagName,attrs:e.attrs,__deep__:t+1,__tagType__:"single"})}});return r}var G=function e(n){var i=[];n.forEach(function(e,t){if(e.type=="beginTag"){i.push([t,e.tagName])}else if(e.type=="endTag"){while(i.length>0){var r=i.pop();if(r[1]==e.tagName){break}else{n[r[0]].type="fullTag"}}}});return n};function H(e,t){if(!y(e))throw new Error("Template must be a String!");var r=V(e.trim());var n=r(),i=[];while(n!=null){if(n.type=="textcode"&&Y.blanksReg.test(n.tagName));else if(n.type=="DOCTYPE");else if(n.type=="comment"){if(t){i.push(n)}}else{i.push(n)}n=r()}i=Z(i);var o=[null],a=0;for(var l=0;l<i.length;l++){var u=l,s=i[l].__deep__;i[l].childNodes=[];i[l].preNode=null;i[l].nextNode=null;var c=o[o.length-1];var f=o.length>1?o[o.length-2]:null;if(s==a){i[u].preNode=c;i[c].nextNode=u;i[u].parentNode=f;i[f].childNodes.push(u);o[o.length-1]=u}else if(s>a){i[u].parentNode=c;if(c!=null)i[c].childNodes.push(u);o.push(u)}else{var d=o[o.length-1-(a-s)];var h=o[o.length-2-(a-s)];i[u].preNode=d;if(d!=null)i[d].nextNode=u;i[u].parentNode=h;if(h!=null)i[h].childNodes.push(u);for(var p=0;p<a-s;p++){o.pop()}o[o.length-1]=u}a=s}return i}function K(e){console.log(H(e))}var Q=["number","json","string","color",function(e,t,r,n){return{attrs:{"fill-color":n("black"),"stroke-color":n("black"),"line-width":e(1)(true),dash:t([]),type:r("fill"),cx:e()(true),cy:e()(true),radius1:e()(true),radius2:e()(true),begin:e(0)(true),deg:e()(true)},region:{default:function e(t,r){t().config({lineWidth:r["line-width"],lineDash:r.dash})[r.type+"Arc"](r.cx,r.cy,r.radius1,r.radius2,r.begin,r.deg)}},link:function e(t,r){t.config({fillStyle:r["fill-color"],strokeStyle:r["stroke-color"],lineWidth:r["line-width"],lineDash:r.dash});var n=r.type;if(w(t[n+"Arc"])){t[n+"Arc"](r.cx,r.cy,r.radius1,r.radius2,r.begin,r.deg)}else{throw new Error("Type error!"+JSON.stringify({series:"arc",type:n}))}}}}];var X=["number","json","string","color",function(e,t,r,n){return{attrs:{"fill-color":n("black"),"stroke-color":n("black"),"line-width":e(1),dash:t([]),type:r("fill"),cx:e()(true),cy:e()(true),radius:e()(true)},region:{default:function e(t,r){t().config({lineWidth:r["line-width"],lineDash:r.dash})[r.type+"Circle"](r.cx,r.cy,r.radius)}},link:function e(t,r){t.config({fillStyle:r["fill-color"],strokeStyle:r["stroke-color"],lineWidth:r["line-width"],lineDash:r.dash});var n=r.type;if(w(t[n+"Circle"])){t[n+"Circle"](r.cx,r.cy,r.radius)}else{throw new Error("Type error!"+JSON.stringify({series:"circle",type:n}))}}}}];var ee=["number","string","boolean","json","color",function(e,t,r,n,i){return{attrs:{"fill-color":i("black"),"stroke-color":i("black"),"line-width":e(1)(true),dash:n([]),type:t("stroke"),close:r(false)},subAttrs:{"move-to":{x:e()(true),y:e()(true)},"line-to":{x:e()(true),y:e()(true)},"bezier-to":{x:e()(true),y:e()(true),cp1x:e()(true),cp1y:e()(true),cp2x:e(null)(true),cp2y:e(null)(true)}},link:function e(t,r){t.config({fillStyle:r["fill-color"],strokeStyle:r["stroke-color"],lineWidth:r["line-width"],lineDash:r.dash});t.beginPath();for(var n=0;n<r._subAttr.length;n++){if(r._subAttr[n].series=="move-to"){t.moveTo(r._subAttr[n].attr.x,r._subAttr[n].attr.y)}else if(r._subAttr[n].series=="line-to"){t.lineTo(r._subAttr[n].attr.x,r._subAttr[n].attr.y)}else if(r._subAttr[n].series=="bezier-to"){if(r._subAttr[n].attr.cp2x==null&&r._subAttr[n].attr.cp2y==null){t.quadraticCurveTo(r._subAttr[n].attr.cp1x,r._subAttr[n].attr.cp1y,r._subAttr[n].attr.x,r._subAttr[n].attr.y)}else{t.bezierCurveTo(r._subAttr[n].attr.cp1x,r._subAttr[n].attr.cp1y,r._subAttr[n].attr.cp2x,r._subAttr[n].attr.cp2y,r._subAttr[n].attr.x,r._subAttr[n].attr.y)}}}if(r.close)t.closePath();var i=r.type;if(w(t[i])){t[i]()}else{throw new Error("Type error!"+JSON.stringify({series:"path",type:i}))}}}}];var te=["number","json","string","color","$rotate",function(e,t,r,n,d){return{attrs:{begin:e(0),deg:e(Math.PI*2),color:n("black"),cx:e(),cy:e(),radius:e(),"mark-direction":r("outer"),"value-position":r("mark"),value:t()},link:function e(t,r){var n=r.value;t.config({lineWidth:1,fillStyle:r.color,strokeStyle:r.color,"font-size":"12",textAlign:"center",textBaseline:"middle",lineDash:[]});t.beginPath().arc(r.cx,r.cy,r.radius,r.begin,r.deg).stroke();var i=r["value-position"]=="mark"?n.length:n.length+1;var o=r.deg/(i-1);for(var a=0;a<i;a++){var l,u;(l=(u=t.beginPath()).moveTo.apply(u,g(d(r.cx,r.cy,r.begin+a*o,r.cx+r.radius,r.cy)))).lineTo.apply(l,g(d(r.cx,r.cy,r.begin+a*o,r.cx+r.radius+5*(r["mark-direction"]=="inner"?-1:1),r.cy))).stroke()}for(var s=0;s<n.length;s++){var c=r.begin+o*(s+(r["value-position"]=="mark"?0:.5));var f=c%(Math.PI*2);t.fillText.apply(t,[n[s]].concat(g(d(r.cx,r.cy,c,r.cx+r.radius+15*(r["mark-direction"]=="inner"?-1:1),r.cy)),[c+(f>0&&f<Math.PI||f>-2*Math.PI&&f<-Math.PI?-Math.PI*.5:Math.PI*.5)]))}}}}];var re=["number","json","string","color",function(e,t,r,n){return{attrs:{"fill-color":n("black"),"stroke-color":n("black"),"line-width":e(1),dash:t([]),type:r("fill"),align:r("left"),baseline:r("top"),x:e()(true),y:e()(true),width:e()(true),height:e()(true)},region:{default:function e(t,r){t().config({lineWidth:r["line-width"],lineDash:r.dash})[r.type+"Rect"](r.x,r.y,r.width,r.height)}},link:function e(t,r){if(r.align=="center")r.x-=r.width*.5;else if(r.align=="right")r.x-=r.width;if(r.baseline=="middle")r.y-=r.height*.5;else if(r.baseline=="bottom")r.y-=r.height;t.config({fillStyle:r["fill-color"],strokeStyle:r["stroke-color"],lineWidth:r["line-width"],lineDash:r.dash});var n=r.type;if(w(t[n+"Rect"])){t[n+"Rect"](r.x,r.y,r.width,r.height)}else{throw new Error("Type error!"+JSON.stringify({series:"rect",type:n}))}}}}];var ne=["number","json","string","color","$dot",function(e,t,r,n,p){return{attrs:{x:e(),y:e(),direction:r("LR"),length:e(),"mark-direction":r("right"),"value-position":r("mark"),color:n("black"),value:t()},link:function e(t,r){var n=r.value;t.config({lineWidth:1,fillStyle:r.color,strokeStyle:r.color,"font-size":"12",textAlign:r.direction=="LR"||r.direction=="RL"?"center":r.direction=="BT"&&r["mark-direction"]=="right"||r.direction=="TB"&&r["mark-direction"]=="left"?"left":"right",lineDash:[],textBaseline:"middle"});var i;var o;if(r.direction=="LR"){i={x:r.x+r.length,y:r.y};o=r["mark-direction"]=="right"?[0,1]:[0,-1]}else if(r.direction=="RL"){i={x:r.x-r.length,y:r.y};o=r["mark-direction"]=="right"?[0,-1]:[0,1]}else if(r.direction=="TB"){i={x:r.x,y:r.y+r.length};o=r["mark-direction"]=="right"?[-1,0]:[1,0]}else if(r.direction=="BT"){i={x:r.x,y:r.y-r.length};o=r["mark-direction"]=="right"?[1,0]:[-1,0]}else{throw new Error("Type error!"+JSON.stringify({series:"ruler",type:type}))}t.beginPath().moveTo(r.x,r.y).lineTo(i.x,i.y).stroke();var a=r["value-position"]=="mark"?n.length:n.length+1;var l=r.length/(a-1);var u=p({d:[i.x-r.x,i.y-r.y],p:[r.x,r.y]});for(var s=0;s<a;s++){var c;var f=u.value();(c=t.beginPath()).moveTo.apply(c,g(f)).lineTo(f[0]+o[0]*5,f[1]+o[1]*5).stroke();u.move(l)}u=p({d:[i.x-r.x,i.y-r.y],p:[r.x,r.y]});if(r["value-position"]=="between")u.move(l*.5);for(var d=0;d<n.length;d++){var h=u.value();t.fillText(n[d],h[0]+o[0]*15,h[1]+o[1]*15);u.move(l)}}}}];var ie=["number","string","json","color",function(e,t,r,n){return{attrs:{"fill-color":n("black"),"stroke-color":n("black"),"font-size":e(16)(true),"font-family":t("sans-serif"),"line-width":e(1),align:t("left"),baseline:t("middle"),type:t("fill"),content:t(null),x:e()(true),y:e()(true),deg:e(0)(true),dash:r([])},region:{default:function e(t,r){t().config({"font-size":r["font-size"],"font-family":r["font-family"],lineWidth:r["line-width"],textAlign:r["align"],textBaseline:r["baseline"],lineDash:r.dash})[r.type+"Text"]((r.content+"").trim(),r.x,r.y,r.deg)}},link:function e(t,r){if(r.content==null){r.content=r._subTexts.join("\n")}t.config({fillStyle:r["fill-color"],strokeStyle:r["stroke-color"],"font-size":r["font-size"],"font-family":r["font-family"],lineWidth:r["line-width"],textAlign:r["align"],textBaseline:r["baseline"],lineDash:r.dash});var n=r.type;if(w(t[n+"Text"])){t[n+"Text"]((r.content+"").trim(),r.x,r.y,r.deg)}else{throw new Error("Type error!"+JSON.stringify({series:"text",type:n}))}}}}];W.prototype.$$templateCompiler=K;W.series({arc:Q,circle:X,path:ee,"polar-ruler":te,rect:re,ruler:ne,text:ie});if((typeof module==="undefined"?"undefined":n(module))==="object"&&n(module.exports)==="object"){module.exports=W}else{window.Clunch=W}})();