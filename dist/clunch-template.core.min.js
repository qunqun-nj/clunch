/*!
 * clunch.js <core@template> - 🎨 The Progressive JavaScript Interactive Picture Framework.
 * git+https://github.com/hai2007/clunch.git
 *
 * author hai2007 < https://hai2007.gitee.io/sweethome >
 *
 * version 0.1.0-alpha.1
 *
 * Copyright (c) 2020 hai2007 走一步，再走一步。
 * Released under the MIT license
 *
 * Date:Thu Dec 03 2020 20:38:32 GMT+0800 (GMT+08:00)
 */
(function(){"use strict";function n(e){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){n=function(e){return typeof e}}else{n=function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return n(e)}function s(e){return t(e)||r(e)||i(e)||o()}function t(e){if(Array.isArray(e))return a(e)}function r(e){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(e))return Array.from(e)}function i(e,t){if(!e)return;if(typeof e==="string")return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor)r=e.constructor.name;if(r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(e,t)}function a(e,t){if(t==null||t>e.length)t=e.length;for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e){var t=n(e);return e!=null&&(t==="object"||t==="function")}var f=Object.prototype.toString;function u(e){if(e==null){return e===undefined?"[object Undefined]":"[object Null]"}return f.call(e)}function e(e){var t=n(e);return t==="string"||t==="object"&&e!=null&&!Array.isArray(e)&&u(e)==="[object String]"}function c(e){if(!l(e)){return false}var t=u(e);return t==="[object Function]"||t==="[object AsyncFunction]"||t==="[object GeneratorFunction]"||t==="[object Proxy]"}function d(e){if(e===null||n(e)!=="object"||u(e)!="[object Object]"){return false}if(Object.getPrototypeOf(e)===null){return true}var t=e;while(Object.getPrototypeOf(t)!==null){t=Object.getPrototypeOf(t)}return Object.getPrototypeOf(e)===t}var h=function e(t,r){return r!==null&&n(r)==="object"&&t.indexOf(r.nodeType)>-1&&!d(r)};var _=e;var x=c;var p=function e(t){return Array.isArray(t)};var v=function e(t){return h([1,9,11],t)};var g=[];var m=13;var b=400;var y=null;function w(t,e,r){var l={timer:function e(t,r,n){if(!t){throw new Error("Tick is required!")}r=r||b;var i=(new Date).valueOf()+"_"+(Math.random()*1e3).toFixed(0);g.push({id:i,createTime:new Date,tick:t,duration:r,callback:n});l.start();return i},start:function e(){if(!y){y=setInterval(l.tick,m)}},tick:function e(){var t,r,e,n,i,a,o,s=g;g=[];g.length=0;for(r=0;r<s.length;r++){i=s[r];t=i.createTime;e=i.tick;a=i.duration;n=i.callback;o=(+new Date-t)/a;o=o>1?1:o;e(o);if(o<1&&i.id){g.push(i)}else if(n){n(o)}}if(g.length<=0){l.stop()}},stop:function e(){if(y){clearInterval(y);y=null}}};var n=l.timer(function(e){t(e)},e,r);return function(){var e;for(e in g){if(g[e].id==n){g[e].id=undefined;return}}}}var $=function e(t,r){for(var n in r){try{t[n]=r[n]}catch(e){throw new Error("Illegal property value！")}}return t};var O={whitespace:"[\\x20\\t\\r\\n\\f]"};var N=function e(t){if(/^[_$]/.test(t)){console.warn("The beginning of _ or $ is not allowed："+t)}};function T(e,t){for(var r in t){try{e[r]=t[r]}catch(e){throw new Error("Illegal property value！")}}return e}function A(l){l=T({u:.5},l);var f,u,c;var d=function e(t){if(f){var r=(t-u)/(c-u),n=r*r,i=r*n;var a=i*f[0]+n*f[1]+r*f[2]+f[3];return a*(c-u)}else throw new Error("You shoud first set the position!")};d.setP=function(e,t,r,n,i,a){if(e<r){u=e;c=r;var o=l.u*i,s=l.u*a;t/=r-e;n/=r-e;f=[2*t-2*n+o+s,3*n-3*t-2*o-s,o,t]}else throw new Error("The point x-position should be increamented!");return d};return d}function k(i){i=$({t:0},i);var a,r;var o=function e(t){if(a){r=-1;while(r+1<a.x.length&&(t>a.x[r+1]||r==-1&&t>=a.x[r+1])){r+=1}if(r==-1||r>=a.h.length)throw new Error("Coordinate crossing!");return a.h[r](t)}else{throw new Error("You shoud first set the position!")}};o.setT=function(e){if(typeof e==="number"){i.t=e}else{throw new Error("Expecting a figure!")}return o};o.setP=function(e){a={x:[],h:[]};var t,r=(e[1][1]-e[0][1])/(e[1][0]-e[0][0]),n;a.x[0]=e[0][0];for(t=1;t<e.length;t++){if(e[t][0]<=e[t-1][0])throw new Error("The point position should be increamented!");a.x[t]=e[t][0];n=t<e.length-1?(e[t+1][1]-e[t-1][1])/(e[t+1][0]-e[t-1][0]):(e[t][1]-e[t-1][1])/(e[t][0]-e[t-1][0]);a.h[t-1]=A({u:(1-i.t)*.5}).setP(e[t-1][0],e[t-1][1],e[t][0],e[t][1],r,n);r=n}return o};return o}function E(e,t){var r=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(e,null):e.currentStyle;return _(t)?r.getPropertyValue(t):r}var S=function e(t){var r=document.getElementsByTagName("head")[0];r.style["color"]=t;var n=E(r,"color");var i=n.replace(/^rgba?\(([^)]+)\)$/,"$1").split(new RegExp("\\,"+O.whitespace));return[+i[0],+i[1],+i[2],i[3]==undefined?1:+i[3]]};var j=function e(t,r){if(!(r&&r>=0&&r<=1))r=1;var n=[];for(var i=1;i<=t;i++){n.push("rgba("+(Math.random(1)*230+20).toFixed(0)+","+(Math.random(1)*230+20).toFixed(0)+","+(Math.random(1)*230+20).toFixed(0)+","+r+")")}return n};function z(e){var f=e||{},u,n;var i=function e(){var o=[],s=0,l=0;(function e(t,r){if(r>l)l=r;var n;for(n=0;n<t.children.length;n++){e(u[t.children[n]],r+1)}u[t.id].left=r+.5;if(n==0){if(o[r]==undefined)o[r]=-.5;if(o[r-1]==undefined)o[r-1]=-.5;u[t.id].top=o[r]+1;var i=o[r]+1+(u[t.pid].children.length-1)*.5;if(i-1<o[r-1])u[t.id].top=o[r-1]+1-(u[t.pid].children.length-1)*.5}else{u[t.id].top=(u[t.children[0]].top+u[t.children[n-1]].top)*.5}if(u[t.id].top<=o[r]){var a=o[r]+1-u[t.id].top;(function e(t,r){u[t].top+=a;if(o[r]<u[t].top)o[r]=u[t].top;var n;for(n=0;n<u[t].children.length;n++){e(u[t].children[n],r+1)}})(t.id,r)}o[r]=u[t.id].top;if(u[t.id].top+.5>s)s=u[t.id].top+.5})(u[n],0);return{node:u,root:n,size:s,deep:l+1}};var a=function e(a){var o={};var t=f.root(a),s,r;s=r=f.id(t);o[s]={data:t,pid:null,id:s,children:[]};var l=1;(function e(t,r){var n=f.child(t,a),i;l+=n?n.length:0;for(i=0;n&&i<n.length;i++){s=f.id(n[i]);o[r].children.push(s);o[s]={data:n[i],pid:r,id:s,children:[]};e(n[i],s)}})(t,s);return{value:[r,o],num:l}};var t=function e(t){var r=a(t);u=r.value[1];n=r.value[0];if(r.num==1){u[n].left=.5;u[n].top=.5;return{deep:1,node:u,root:n,size:1}}return i()};t.root=function(e){f.root=e;return t};t.child=function(e){f.child=e;return t};t.id=function(e){f.id=e;return t};return t}var R=function e(t,r,n,i,a){var o=Math.cos(n),s=Math.sin(n);return[+((i-t)*o-(a-r)*s+t).toFixed(7),+((i-t)*s+(a-r)*o+r).toFixed(7)]};var P=function e(t,r,n,i,a){var o=Math.sqrt(t*t+r*r);return[+(t*n/o+i).toFixed(7),+(r*n/o+a).toFixed(7)]};var C=function e(t,r,n,i,a){return[+(n*(i-t)+t).toFixed(7),+(n*(a-r)+r).toFixed(7)]};var F=function e(a){a=$({d:[1,1],c:[0,0],p:[0,0]},a);var o={rotate:function e(t){var r=a.d[0]+a.p[0],n=a.d[1]+a.p[1];var i=R(a.p[0],a.p[1],t,r,n);a.d=[i[0]-a.p[0],i[1]-a.p[1]];return o},move:function e(t){a.p=P(a.d[0],a.d[1],t,a.p[0],a.p[1]);return o},scale:function e(t){a.p=C(a.c[0],a.c[1],t,a.p[0],a.p[1]);return o},value:function e(){return a.p}};return o};function I(y){y=$({"begin-deg":0,deg:Math.PI*2},y);var _=z().root(y.root).child(y.child).id(y.id);var t=function e(t){var r=_(t);for(var n in r.node){r.node[n].deep=r.node[n].left-.5}if(y.type==="LR"||y.type==="RL"){var i=y.width/r.deep;if("RL"===y.type)i*=-1;var a=y.height/(r.size- -.5);for(var o in r.node){var s=r.node[o];r.node[o].left=+(("RL"==y.type?y.width:0)- -s.left*i).toFixed(7);r.node[o].top=+(s.top*a).toFixed(7)}}else if(y.type==="TB"||y.type==="BT"){var l=y.height/r.deep;if("BT"==y.type)l*=-1;var f=y.width/(r.size- -.5);var u,c;for(var d in r.node){var h=r.node[d];u=h.left;c=h.top;r.node[d].top=+(("BT"==y.type?y.height:0)- -u*l).toFixed(7);r.node[d].left=+(c*f).toFixed(7)}}else if(y.type==="circle"){if(r.deep==1&&r.size==1){r.node[r.root].left=y.cx;r.node[r.root].top=y.cy}else{var p=y.radius/(r.deep-1);var v=y.deg/(r.size- -.5);for(var g in r.node){var m=r.node[g];r.node[g].deg=(y["begin-deg"]- -v*m.top)%(Math.PI*2);var b=R(y.cx,y.cy,r.node[g].deg,y.cx- -p*(m.left-.5),y.cy);r.node[g].left=+b[0];r.node[g].top=+b[1]}}}if(x(y.drawer)){y.drawer(r);return e}else{return r}};t.config=function(e){y=$(y,e);return t};t.drawer=function(e){y.drawer=e;return t};return t}function M(i){var t=[];var e=function e(n){if(["boolean","number","json","string","color","any"].indexOf(i[n])>-1){t.unshift(function(t){var r=arguments.length>0?false:true;return function(e){return{type:i[n],required:r,animation:e,default:t}}})}else{t.unshift({$animation:w,$cardinal:k,$formatColor:S,$getRandomColors:j,$tree:I,$dot:F,$rotate:R,$move:P,$scale:C}[i[n]])}};for(var r=i.length-2;r>=0;r--){e(r)}return i[i.length-1].apply(this,t)}function D(e,b){var y=0;return function e(t,r){var n=[];for(var i=0;i<t.length;i++){var a=t[i];if(r||a.name in b){var o={name:a.name,attrs:{},events:[],scope:{},index:y++};var s=r?{attrs:b[r].subAttrs[a.name]}:b[a.name];for(var l in a.attrs){if(/^c\-bind\:/.test(l)){a.attrs[l.replace(/^c\-bind\:/,"")]={isBind:true,express:a.attrs[l]}}else if(/^c\-on\:/.test(l)){var f=(l.replace(/^c\-on\:/,"")+"@default").split("@");o.events.push({event:f[0],region:f[1],method:a.attrs[l]})}else if("c-for"==l){var u=/^ {0,}\(/.test(a.attrs[l]);var c=u?/^ {0,}\( {0,}([0-9a-zA-Z_$]+) {0,}, {0,}([0-9a-zA-Z_$]+) {0,}\) {1,}in {1,}([^ ]+) {0,}$/.exec(a.attrs[l]):/^ {0,}([0-9a-zA-Z_$]+) {1,}in {1,}([^ ]+) {0,}$/.exec(a.attrs[l]);o["c-for"]={key:u?c[2]:null,value:c[1],data:u?c[3]:c[2]}}else if("c-if"==l){o["c-if"]=a.attrs[l]}else{a.attrs[l]={isBind:false,express:a.attrs[l]}}}for(var d in s.attrs){var h=s.attrs[d];if(h.required&&!(d in a.attrs)){throw new Error("attrs."+d+" is required for series "+a.name+"!")}o.attrs[d]={animation:h.animation,type:h.type,value:d in a.attrs?a.attrs[d]:{isBind:false,express:h["default"]}}}var p=[],v=[],g=[];if(a.children){for(var m=0;m<a.children.length;m++){if(_(a.children[m])){g.push(a.children[m])}else if(s.subAttrs&&a.children[m].name in s.subAttrs){v.push(a.children[m])}else{p.push(a.children[m])}}}o.children=e(p);o.subAttrs=e(v,a.name);o.text=g;n.push(o)}else{console.error("Series "+a.name+" is not defined!")}}return n}(e)}function W(e){e.prototype.$$init=function(e){this.__options=e;this.__data=p(e.data)?M(e.data):x(e.data)?e.data():e.data;this._isMounted=false;this._isDestroyed=false;for(var t in e.methods){N(t);this[t]=p(e.methods[t])?M(e.methods[t]):e.methods[t]}for(var r in this.__data){N(r);this[r]=this.__data[r]}this.__renderFlag=!!e.render||!!e.template;if(!!e.render){this.__renderAOP=D(e.render,this.__defineSerirs)}else if(!!e.template){this.__renderOptions=this.$$templateCompiler(e.template);this.__renderAOP=D(this.__renderOptions,this.__defineSerirs)}this.__observeWatcher={flag:false,stop:null}}}function L(e){e.prototype.$$lifecycle=function(e){if(x(e)){e()}else{if(["created","beforeMount","mounted","beforeUnmount","unmounted","beforeUpdate","updated","beforeResize","resized","beforeDraw","drawed","beforeDestroy","destroyed"].indexOf(e)>-1&&x(this.__options[e])){this.__options[e].call(this)}}return this}}var B={blankReg:new RegExp("[\\x20\\t\\r\\n\\f]"),blanksReg:/^[\x20\t\r\n\f]{0,}$/,identifier:/^[a-zA-Z_$][0-9a-zA-Z_$]{0,}$/};var U=["+","-","*","/","%","&","|","!","?",":","[","]","(",")",">","<","="];var V=["+","-","*","/","%","&","|","!","?",":",">","<","=","<=",">=","==","===","!=","!=="];function Y(e,r,t){r=r.trim();var n=-1,i=null;var a=function e(){i=n++<r.length-1?r[n]:null;return i};var o=function e(t){return r.substring(n,t+n>r.length?r.length:t+n)};a();var s=[];while(true){if(n>=r.length)break;if(U.indexOf(i)>-1){if(["&","|","="].indexOf(i)>-1){if(["==="].indexOf(o(3))>-1){s.push(o(3));n+=2;a()}else if(["&&","||","=="].indexOf(o(2))>-1){s.push(o(2));n+=1;a()}else{throw new Error("Illegal expression : ".concat(r,"\nstep='analyseExpress',index=").concat(n))}}else{if(["!=="].indexOf(o(3))>-1){s.push(o(3));n+=2;a()}else if([">=","<=","!="].indexOf(o(2))>-1){s.push(o(2));n+=1;a()}else{s.push(i);a()}}}else if(['"',"'"].indexOf(i)>-1){var l="",f=i;a();while(i!=f){if(n>=r.length){throw new Error("String unclosed error : ".concat(r,"\nstep='analyseExpress',index=").concat(n))}l+=i;a()}s.push(l+"@string");a()}else if(/\d/.test(i)){var u="no";var c=i;a();while(n<r.length){if(/\d/.test(i)){c+=i;if(u=="error")u="yes"}else if("."==i&&u=="no"){c+=i;u="error"}else{break}a()}if(u=="error")c+="0";s.push(+c)}else if(["null","true"].indexOf(o(4))>-1){s.push({null:null,true:true}[o(4)]);n+=3;a()}else if(["false"].indexOf(o(5))>-1){s.push({false:false}[o(5)]);n+=4;a()}else if(["undefined"].indexOf(o(9))>-1){s.push({undefined:undefined}[o(9)]);n+=8;a()}else if(B.blankReg.test(i)){do{a()}while(B.blankReg.test(i)&&n<r.length)}else{var d=false;if(i=="."){d=true;a()}if(B.identifier.test(i)){var h=1;while(n+h<=r.length&&B.identifier.test(o(h))){h+=1}if(d){s.push("[");s.push(o(h-1)+"@string");s.push("]")}else{var p=o(h-1);var v=p in t?t[p]:e[p];s.push(_(v)?v+"@string":v)}n+=h-2;a()}else{throw new Error("Illegal express : ".concat(r,"\nstep='analyseExpress',index=").concat(n))}}}var g=0;for(var m=0;m<s.length;m++){if(["+","-"].indexOf(s[m])>-1&&(m==0||V.indexOf(s[g-1])>-1)){s[g++]=+(s[m]+s[m+1]);m+=1}else{s[g++]=s[m]}}s.length=g;return s}var q=function e(t){if(typeof t=="string")return t.replace(/@string$/,"");return t};var Z=function e(t){if(typeof t=="string")return t+"@string";return t};function H(e){var t=0,r=0;for(;r<e.length;r++){if(e[r]=="!"){e[t]=!e[++r]}else e[t]=e[r];t+=1}if(t==1)return q(e[0]);e.length=t;t=0;for(r=0;r<e.length;r++){if(e[r]=="*"){e[t-1]=q(e[t-1])*q(e[++r])}else if(e[r]=="/"){e[t-1]=q(e[t-1])/q(e[++r])}else if(e[r]=="%"){e[t-1]=q(e[t-1])%q(e[++r])}else{e[t++]=e[r]}}if(t==1)return q(e[0]);e.length=t;t=0;for(r=0;r<e.length;r++){if(e[r]=="+"){e[t-1]=Z(q(e[t-1])+q(e[++r]))}else if(e[r]=="-"){e[t-1]=q(e[t-1])-q(e[++r])}else e[t++]=e[r]}if(t==1)return q(e[0]);e.length=t;t=0;for(r=0;r<e.length;r++){if(e[r]==">"){e[t-1]=q(e[t-1])>q(e[++r])}else if(e[r]=="<"){e[t-1]=q(e[t-1])<q(e[++r])}else if(e[r]=="<="){e[t-1]=q(e[t-1])<=q(e[++r])}else if(e[r]==">="){e[t-1]=q(e[t-1])>=q(e[++r])}else e[t++]=e[r]}if(t==1)return q(e[0]);e.length=t;t=0;for(r=0;r<e.length;r++){if(e[r]=="=="){e[t-1]=q(e[t-1])==q(e[++r])}else if(e[r]=="==="){e[t-1]=q(e[t-1])===q(e[++r])}else if(e[r]=="!="){e[t-1]=q(e[t-1])!=q(e[++r])}else if(e[r]=="!=="){e[t-1]=q(e[t-1])!==q(e[++r])}else e[t++]=e[r]}if(t==1)return q(e[0]);e.length=t;t=0;for(r=0;r<e.length;r++){if(e[r]=="&&"){e[t-1]=q(e[t-1])&&q(e[1+r]);r+=1}else if(e[r]=="||"){e[t-1]=q(e[t-1])||q(e[1+r]);r+=1}else e[t++]=e[r]}if(t==1)return q(e[0]);e.length=t;t=0;for(r=0;r<e.length;r++){if(e[r]=="?"){e[t-1]=q(e[t-1])?q(e[r+1]):q(e[r+3]);r+=3}else e[t++]=e[r]}if(t==1)return q(e[0]);e.length=t;throw new Error("Unrecognized expression : ["+e.toString()+"]")}function G(t,r,n){var e=r[0]in n?n[r[0]]:t[r[0]];for(var i=1;i<r.length;i++){try{e=e[r[i]]}catch(e){console.error({target:t,scope:n,expressArray:r,index:i});throw e}}return e}var J=function e(t,r,n){if(r.indexOf("(")>-1){var i=[],a=[],o=0;for(var s=0;s<r.length;s++){if(r[s]=="("){if(o>0){a.push("(")}o+=1}else if(r[s]==")"){if(o>1)a.push(")");o-=1;if(o==0){var l=H(e(t,a));i.push(_(l)?l+"@string":l);a=[]}}else{if(o>0)a.push(r[s]);else i.push(r[s])}}r=i}return K(r)};var K=function e(t){var r=true;while(r){r=false;var n=[],i=[],a=false;for(var o=0;o<t.length;o++){if(t[o]=="["&&o!=0&&t[o-1]!="]"){if(a){n.push("[");for(var s=0;s<i.length;s++){n.push(i[s])}}else{a=true}i=[]}else if(t[o]=="]"&&a){r=true;var l=H(i);var f=n[n.length-1][l];n[n.length-1]=_(f)?f+"@string":f;a=false}else{if(a){i.push(t[o])}else{n.push(t[o])}}}t=n}return t};var Q=function e(t){var r=[],n=[];for(var i=0;i<t.length;i++){if(t[i]=="["){n=[]}else if(t[i]=="]"){r.push(H(n))}else{n.push(t[i])}}return r};function X(e,t,r){var n=J(e,t);var i;if(n[0]!="["){i=[H(n)]}else if(n[n.length-1]=="]"){i=Q(n)}else{var a=n.lastIndexOf("]");var o=Q(n.slice(0,a+1));i=[H([G(e,o,r)].concat(s(n.slice(a+1))))]}return i}var ee=function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var i=Y(t,r,n);var a=X(t,i,n);if(a.length>1)throw new Error("Illegal expression : ".concat(r,"\nstep='evalExpress',path=").concat(a,",expressArray=").concat(i));return a[0]};var te=function e(t,r,n){if(r.animation&&t.value!=r.value){switch(r.type){case"number":{return{type:r.type,animation:true,value:(r.value-t.value)*n+t.value}}}}return r};function re(c,d){var h={};for(var e=0;e<c.length;e++){var t={};for(var r=0;r<c[e].subAttr.length;r++){t[c[e].subAttr[r].id]=r}h[c[e].id]={index:e,subLinkIdToIndex:t}}return function(e){if(e==1)return d;var t=[];for(var r=0;r<d.length;r++){if(d[r].id in h){var n=c[h[d[r].id].index];var i={};for(var a in n.attr){i[a]=te(n.attr[a],d[r].attr[a],e)}var o=[];for(var s=0;s<d[r].subAttr.length;s++){if(d[r].subAttr[s].id in h[d[r].id].subLinkIdToIndex){var l=n.subAttr[h[d[r].id].subLinkIdToIndex[d[r].subAttr[s].id]];var f={};for(var u in l.attr){f[u]=te(l.attr[u],d[r].subAttr[s].attr[u],e)}o.push({id:l.id,name:l.name,subText:l.subText,subAttr:[],attr:f})}else{o.push(d[r].subAttr[s])}}t.push({id:d[r].id,name:d[r].name,subText:d[r].subText,subAttr:o,attr:i})}}return t}}function ne(e){e.prototype.$$updateView=function(){this.$$lifecycle("beforeDraw");this.$$lifecycle("drawed")};e.prototype.$$updateWithSize=function(){this.$$lifecycle("beforeResize");this.$$lifecycle("resized")};e.prototype.$$updateWithData=function(){var t=this;if(x(this.__observeWatcher.stop)){this.__observeWatcher.stop()}else{this.$$lifecycle("beforeUpdate")}this.__events={click:{},dblclick:{},mousemove:{},mousedown:{},mouseup:{}};var m=[],b=this;(function e(t,r,n,i){var a=[];for(var o=0;o<t.length;o++){var s=i+t[o].index;for(var l in r){if(!(l in t[o].scope)){t[o].scope[l]=r[l]}}if("c-for"in t[o]){var f=t[o]["c-for"];delete t[o]["c-for"];var u=ee(b,f.data,t[o].scope);for(var c in u){t[o].scope[f.value]=u[c];if(f.key!=null)t[o].scope[f.key]=c;e([t[o]],{},false,s+"for"+c+"-")}continue}if("c-if"in t[o]&&!ee(b,t[o]["c-if"],t[o].scope))continue;delete t[o]["c-if"];e(t[o].children,t[o].scope,false,s+"-");if(t[o].name!="group"){var d={name:t[o].name,attr:{},subAttr:[],subText:t[o].text,id:s};for(var h in t[o].attrs){var p=t[o].attrs[h];d.attr[h]={animation:p.animation,type:p.type,value:p.value.isBind?ee(b,p.value.express,t[o].scope):p.value.express}}d.subAttr=e(t[o].subAttrs,t[o].scope,true,s+"-");for(var v=0;v<t[o].events.length;v++){var g=t[o].events[v];b.__events[g.event][m.length+"@"+g.region]=b[g.method]}if(n)a.push(d);else m.push(d)}}return a})(this.__renderAOP,{},false,"");if(!this.__renderSeries){this.__renderSeries=m;this.$$updateView();this.$$lifecycle("updated");return}var r=re(this.__renderSeries,m);this.__observeWatcher.stop=w(function(e){t.__renderSeries=r(e);t.$$updateView()},500,function(e){if(e==1){t.__observeWatcher.stop=null;t.$$lifecycle("updated")}})}}function ie(n){var e=function e(t){var r=n.__data[t];n[t]=r;Object.defineProperty(n,t,{get:function e(){return r},set:function e(t){r=t;if(!n.__observeWatcher.flag){window.setTimeout(function(){n.$$updateWithData();n.__observeWatcher.flag=false},0)}n.__observeWatcher.flag=true}})};for(var t in n.__data){e(t)}}function ae(t){if(!(this instanceof ae)){console.error("Clunch is a constructor and should be called with the `new` keyword");return}["beforeCreate","created","beforeMount","mounted","beforeUnmount","unmounted","beforeUpdate","updated","beforeResize","resized","beforeDestroy","destroyed"].forEach(function(e){if(p(t[e])){t[e]=M(t[e])}});this.$$lifecycle(t.beforeCreate);this.$$init(t);ie(this);this.$$lifecycle("created");if(v(t.el)){this.$mount(t.el)}}W(ae);L(ae);ne(ae);ae.prototype.__defineSerirs={};function oe(e){try{e.__resizeObserver=new ResizeObserver(function(){e.$$updateWithSize()});e.__resizeObserver.observe(e.__el)}catch(e){console.info(e);console.error("ResizeObserver undefined!")}}function se(e){var t=M(e);for(var r in t.attrs){if(x(t.attrs[r])){t.attrs[r]=t.attrs[r](false)}}for(var n in t.subAttrs){for(var i in t.subAttrs[n]){if(x(t.subAttrs[n][i])){t.subAttrs[n][i]=t.subAttrs[n][i](false)}}}return t}function le(n){n.series=function(e,t){if(arguments.length==1){for(var r in e){n.series(r,e[r])}}else{if(x(n.prototype.__defineSerirs[e])){console.warn("The series["+e+"] has been registered!")}n.prototype.__defineSerirs[e]=se(t)}return n}}le(ae);ae.prototype.$mount=function(e){if(this._isDestroyed){console.warn("The clunch has been destroyed!");return}if(this._isMounted){console.warn("The clunch is already mounted!");return}if(!v(e)){console.warn("Mount node does not exist!");return}this.$$lifecycle("beforeMount");if(!this.__renderFlag){this.__renderOptions=this.$$templateCompiler(e.innerHTML);this.__renderAOP=D(this.__renderOptions,this.__defineSerirs)}this.__el=e;e.innerHTML="<canvas>非常抱歉，您的浏览器不支持canvas!</canvas>";this.__canvas=e.getElementsByTagName("canvas")[0];this.$$updateWithData();oe(this);this._isMounted=true;this.$$lifecycle("mounted");return this};ae.prototype.$unmount=function(){};ae.prototype.$destroy=function(){};ae.series("group",[function(){return{attrs:{}}}]);function fe(a){var o={},s=0;a=a.trim();var e=function e(){var t="",r="";for(;s<a.length;s++){if(B.blanksReg.test(a[s])||s==a.length-1){t+=a[s];if(!B.blanksReg.test(t)){o[t.trim()]=""}s+=1;break}else if(a[s]=="="){s+=1;var n=null,i=-1;if(a.substr(s,1)=='"'||a.substr(s,1)=="'"){n=a.substr(s,1);i=1;s+=1}else if(a.substr(s,2)=='"'||a.substr(s,2)=="'"){n=a.substr(s,2);i=2;s+=2}if(n!==null){for(;s<a.length;s++){if(a.substr(s,i)==n){o[t.trim()]=r.trim();s+=2;break}else{r+=a[s]}}}else{for(;s<a.length;s++){if(B.blanksReg.test(a[s])){o[t.trim()]=r.trim();s+=1;break}else{r+=a[s]}}}break}else{t+=a[s]}}if(s<a.length){e()}};e();return o}function ue(f){var u=-1,c=null;var d=false,h="";var p=["script","pre","style","code"];var v=function e(){c=u++<f.length-1?f[u]:null;return c};var g=function e(t){return f.substring(u,t+u>f.length?f.length:t+u)};v();while(B.blankReg.test(c)&&u<f.length-1){v()}return function(){var e=c,t={};if(e==null)return null;if(d){t.type="textcode";t.tagName=e;while(g(h.length+3)!="</"+h+">"&&u<f.length){t.tagName+=v()}t.tagName=t.tagName.replace(/<$/,"");d=false;return t}if(g(4)=="\x3c!--"){t.type="comment";t.tagName=e;while(g(3)!="--\x3e"&&u<f.length){t.tagName+=v()}v();v();v();t.tagName=t.tagName.replace(/^<!--/,"").replace(/-$/,"");return t}if(g(9)=="<!DOCTYPE"){t.type="DOCTYPE";t.tagName=e;while(g(1)!=">"&&u<f.length){t.tagName+=v()}v();t.tagName=t.tagName.replace(/^<!DOCTYPE/,"").replace(/>$/,"");return t}else if(e=="<"){var r=false,n=null,i=null;while(r||c!=">"&&u<f.length){e+=v();if(r){var a=g(i+1).substring(1);if(a==n){r=false}}else{var o=g(2);if(o=='="'||o=="='"){n=o.replace("=","");i=1;r=true}o=g(3);if(o=='="'||o=="='"){n=o.replace("=","");i=2;r=true}}}if(/^<\//.test(e)){t.tagName=e.replace(/^<\//,"").replace(/>$/,"");t.type="endTag"}else{if(/\/>$/.test(e)){t.type="fullTag";e=e.replace(/\/>$/,"")}else{t.type="beginTag";e=e.replace(/>$/,"")}e=e.replace(/^</,"");t.tagName="";var s=0;for(;s<e.length;s++){if(e[s]==" ")break;t.tagName+=e[s]}var l=e.substring(s);if(B.blanksReg.test(l)){t.attrs={}}else{t.attrs=fe(l)}}}else{t.type="textcode";t.tagName=c;while(g(1)!="<"&&u<f.length){t.tagName+=v()}t.tagName=t.tagName.replace(/<$/,"");u-=1}if(t.type=="beginTag"){if(p.indexOf(t.tagName.toLowerCase())>-1){d=true;h=t.tagName}}else if(t.type=="endTag"){if(p.indexOf(t.tagName.toLowerCase())>-1){d=false}}v();return t}}function ce(e){e=de(e);var t=0,r=[];e.forEach(function(e){if(e.type=="beginTag"){r.push({type:"tag",name:e.tagName,attrs:e.attrs,__deep__:++t,__tagType__:"double"})}else if(e.type=="endTag"){t-=1}else if(e.type=="textcode"){r.push({type:"text",content:e.tagName,__deep__:t+1})}else if(e.type=="comment"){r.push({type:"comment",content:e.tagName,__deep__:t+1})}else{r.push({type:"tag",name:e.tagName,attrs:e.attrs,__deep__:t+1,__tagType__:"single"})}});return r}var de=function e(n){var i=[];n.forEach(function(e,t){if(e.type=="beginTag"){i.push([t,e.tagName])}else if(e.type=="endTag"){while(i.length>0){var r=i.pop();if(r[1]==e.tagName){break}else{n[r[0]].type="fullTag"}}}});return n};function he(e,t){if(!_(e))throw new Error("Template must be a String!");var r=ue(e.trim());var n=r(),i=[];while(n!=null){if(n.type=="textcode"&&B.blanksReg.test(n.tagName));else if(n.type=="DOCTYPE");else if(n.type=="comment"){if(t){i.push(n)}}else{i.push(n)}n=r()}i=ce(i);var a=[null],o=0;for(var s=0;s<i.length;s++){var l=s,f=i[s].__deep__;i[s].childNodes=[];i[s].preNode=null;i[s].nextNode=null;var u=a[a.length-1];var c=a.length>1?a[a.length-2]:null;if(f==o){i[l].preNode=u;i[u].nextNode=l;i[l].parentNode=c;i[c].childNodes.push(l);a[a.length-1]=l}else if(f>o){i[l].parentNode=u;if(u!=null)i[u].childNodes.push(l);a.push(l)}else{var d=a[a.length-1-(o-f)];var h=a[a.length-2-(o-f)];i[l].preNode=d;if(d!=null)i[d].nextNode=l;i[l].parentNode=h;if(h!=null)i[h].childNodes.push(l);for(var p=0;p<o-f;p++){a.pop()}a[a.length-1]=l}o=f}return i}function pe(e){var a=he("<clunch>"+e+"</clunch>");return function e(t){var r=[];for(var n=0;n<t.childNodes.length;n++){var i=a[t.childNodes[n]];if(i.type=="tag"){r.push({name:i.name,attrs:i.attrs,children:e(i)})}else{r.push(i.content.trim())}}return r}(a[0])}ae.prototype.$$templateCompiler=pe;if((typeof module==="undefined"?"undefined":n(module))==="object"&&n(module.exports)==="object"){module.exports=ae}else{window.Clunch=ae}})();